(this["webpackJsonpsimple-vapile"]=this["webpackJsonpsimple-vapile"]||[]).push([[0],{213:function(e,t,n){},214:function(e,t,n){},261:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),i=n(18),r=n.n(i),o=(n(213),n(5)),s=(n.p,n(214),n(51)),l=n.n(s),u=n(17),d=n(340),b=n(371),j=n(358),f=n(364),O=n(372),p=n(344),h=Object(a.createContext)(),m=n(44),g=n.n(m),v="".concat("http://localhost:5001");v="".concat("https://neru-ca37991c-neru-mta-project-prod.euw1.serverless.vonage.com");var x=function(e){return g.a.post("".concat(v,"/render"),{roomName:e})},C=function(e){return g.a.get("".concat(v,"/archive/stop/").concat(e))},y=n(22),S=n(32);var k="http://localhost:5001";console.log("production",k),k="".concat("https://neru-ca37991c-neru-mta-project-prod.euw1.serverless.vonage.com");var I=function(){var e=Object(S.a)(Object(y.a)().mark((function e(t){return Object(y.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",g.a.get("".concat(k,"/session/").concat(t)));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=Object(S.a)(Object(y.a)().mark((function e(t){return Object(y.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",g.a.get("".concat(k,"/session/").concat(t,"?role=virtual")));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=Object(S.a)(Object(y.a)().mark((function e(t,n,a,c){return Object(y.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",g.a.post("".concat(k,"/startStreaming"),{streamId:t,sessionId:n,streamName:a,specialty:c}));case 1:case"end":return e.stop()}}),e)})));return function(t,n,a,c){return e.apply(this,arguments)}}();function E(){var e=Object(u.h)().roomName,t=Object(a.useContext)(h).preferences,n=Object(a.useState)(!1),i=Object(o.a)(n,2),r=i[0],s=i[1],d=Object(a.useState)(!1),b=Object(o.a)(d,2),j=b[0],f=b[1],O=Object(a.useRef)(),p=Object(a.useState)(null),m=Object(o.a)(p,2),g=m[0],v=m[1],x=Object(a.useState)(null),C=Object(o.a)(x,2),k=(C[0],C[1]),I=Object(a.useState)(null),w=Object(o.a)(I,2),E=(w[0],w[1]),D=function(){var e=Object(a.useState)({audioInputDevices:[],videoInputDevices:[],audioOutputDevices:[]}),t=Object(o.a)(e,2),n=t[0],c=t[1],i=Object(a.useCallback)(Object(S.a)(Object(y.a)().mark((function e(){return Object(y.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices){e.next=3;break}return console.warn("enumerateDevices() not supported."),e.abrupt("return");case 3:return e.abrupt("return",new Promise((function(e,t){l.a.getDevices(function(){var e=Object(S.a)(Object(y.a)().mark((function e(n,a){var i,r,o;return Object(y.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n&&t(n),e.next=3,l.a.getAudioOutputDevices();case 3:i=e.sent,r=a.filter((function(e){return"audioinput"===e.kind.toLowerCase()})),o=a.filter((function(e){return"videoinput"===e.kind.toLowerCase()})),c({audioInputDevices:r,videoInputDevices:o,audioOutputDevices:i});case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())})));case 4:case"end":return e.stop()}}),e)}))),[]);return Object(a.useEffect)((function(){return navigator.mediaDevices.addEventListener("devicechange",i),i(),function(){navigator.mediaDevices.removeEventListener("devicechange",i)}}),[i]),{deviceInfo:n,getDevices:i}}(),T=D.deviceInfo,A=D.getDevices,R=c.a.useCallback((function(n){var a=n.stream;if("EC"!==a.name){console.log(a),t.streamId=a.id;var c=a.publisher.session.id;console.log(c),E(c),console.log({roomName:e,specialty:localStorage.getItem("specialty")}),N(a.id,c,a.name,localStorage.getItem("specialty")).then((function(e){console.log(e.data),console.log("setting connectionId "+e.data.connectionId),k(e.data.connectionId)})).catch((function(e){return console.log(e)})),s(!0)}}),[t,e]),P=Object(a.useCallback)((function(e){e.stream;console.log("destroyed publisher"),O.current=null,f(!1),s(!1)}),[]),M=Object(a.useCallback)((function(e,t){if(console.log("UsePublisher - initPublisher"),!O.current){e||console.log("UsePublisher - Container not available");var n=Object.assign({},t,{width:"100%",height:"100%",name:localStorage.getItem("username"),publishVideo:!0,publishAudio:!0,style:{buttonDisplayMode:"on",nameDisplayMode:"off"},insertMode:"append",showControls:!0,fitMode:"contain"});return console.log("usePublisher finalPublisherOptions",n),O.current=l.a.initPublisher(e,n,(function(e){e&&(console.log("[usePublisher]",e),O.current=null),console.log("Publisher Created")})),O.current.on("accessAllowed",A),f(!0),O.current.on("streamCreated",R),O.current.on("streamDestroyed",P),O.current.on("destroyed",(function(){O.current=null,console.log(O),console.log("publisherRef.current Destroyed")})),function(){O.current.off("streamCreated",R),O.current.off("streamDestroyed",P),O.current.off("destroyed",(function(){}))}}console.log("UsePublisher - Already initiated")}),[A,R,P]),V=Object(a.useCallback)((function(){O.current&&O.current&&O.current.destroy()}),[]),B=Object(a.useCallback)((function(e){var t=e.session,n=e.containerId,a=e.publisherOptions;if(O.current||M(n,a),t&&O.current&&!r)return new Promise((function(e,n){t.publish(O.current,(function(t){t&&(console.log("Publisher Error",t),s(!1),O.current=null,v(!0),n(t)),console.log("Published"),e(O.current)}))}));O.current}),[M,r]),F=Object(a.useCallback)((function(e){var t=e.session;O.current&&r&&t&&(t.unpublish(O.current),s(!1),O.current=null)}),[r]);return{publisher:O.current,initPublisher:M,destroyPublisher:V,publish:B,pubInitialised:j,unpublish:F,isPublishing:r,publisherError:g,deviceInfo:T}}var D=n(156),T=n.n(D),A=n(373),R=n(2),P=c.a.memo((function(e){var t=e.hasAudio,n=e.onAudioChange,a=e.className;return Object(R.jsxs)("div",{className:a,children:[Object(R.jsx)(T.a,{}),Object(R.jsx)("div",{children:"Microphone"}),Object(R.jsx)(A.a,{checked:t,onChange:n,name:"AudioToggle"})]})})),M=n(158),V=n.n(M),B=c.a.memo((function(e){var t=e.hasVideo,n=e.onVideoChange,a=e.className;return console.log("Video Setting",t),Object(R.jsxs)("div",{className:a,children:[Object(R.jsx)(V.a,{}),Object(R.jsx)("div",{children:"Video"}),Object(R.jsx)(A.a,{checked:t,onChange:n,name:"VideoToggle"})]})})),F=n(338),z=n(339),L=n(109),K=n(108),W=Object(F.a)((function(e){return{waitingRoomContainer:{position:"absolute",left:"50%",top:"50%",display:"flex",flexDirection:"column",transform:"translate(-50%, -50%)",backgroundColor:z.a[100],padding:"10px 20px",borderRadius:5,width:"360px"},waitingRoomVideoContainer:{width:"360px",height:"264px"},deviceContainer:{display:"flex",flexDirection:"column",margin:"5px 0"},deviceSettings:{display:"flex",justifyContent:"space-around",alignItems:"center"},selectWidth:{width:"200px"},networkTestContainer:{display:"flex",flexDirection:"column",margin:"10px 5px"},flex:{display:"flex"},green:{color:L.a[600]},red:{color:K.a[600]},containerCenter:{display:"flex",justifyContent:"center",alignItems:"center",margin:"3px",flexDirection:"column"}}})),Y=function(e,t){var n="";if(console.log("getSourceDeviceId",e,t),!e||!t)return n;for(var a=0;a<e.length;a+=1)if(e[a].label===t.label){n=e[a].deviceId;break}return n};function _(){var e=W(),t=Object(a.useContext)(h),n=(t.preferences,t.setPreferences),i=Object(u.g)().push,r=!0,s=!0,m=Object(a.useState)(r),g=Object(o.a)(m,2),v=g[0],x=g[1],C=Object(a.useState)(s),y=Object(o.a)(C,2),S=y[0],k=y[1],I=Object(a.useState)(void 0),w=Object(o.a)(I,2),N=w[0],D=w[1],T=Object(a.useState)(void 0),A=Object(o.a)(T,2),M=A[0],V=A[1],F=Object(a.useState)(void 0),z=Object(o.a)(F,2),L=z[0],K=z[1],_=Object(a.useState)(""),J=Object(o.a)(_,2),U=J[0],G=J[1],H=Object(a.useState)(""),q=Object(o.a)(H,2),Q=q[0],X=q[1],Z=Object(a.useState)(""),$=Object(o.a)(Z,2),ee=$[0],te=$[1],ne=Object(a.useState)("PRIMARYCARE"),ae=Object(o.a)(ne,2),ce=ae[0],ie=ae[1],re=Object(a.useState)(""),oe=Object(o.a)(re,2),se=oe[0],le=oe[1],ue=Object(a.useState)(""),de=Object(o.a)(ue,2),be=de[0],je=de[1],fe=Object(a.useState)(!1),Oe=Object(o.a)(fe,2),pe=Oe[0],he=Oe[1],me=Object(a.useState)(!1),ge=Object(o.a)(me,2),ve=ge[0],xe=ge[1],Ce=Object(a.useRef)(),ye=E(),Se=ye.publisher,ke=ye.initPublisher,Ie=(ye.destroyPublisher,ye.deviceInfo),we=ye.pubInitialised,Ne=c.a.useCallback((function(e){x(e.target.checked)}),[]),Ee=c.a.useCallback((function(e){k(e.target.checked)}),[]),De=c.a.useCallback((function(e){var t=e.target.value;X(e.target.value),Se.setVideoSource(t),D(t)}),[Se,X,D]),Te=c.a.useCallback((function(e){var t=e.target.value;G(t),Se.setAudioSource(t),V(t)}),[Se,G,V]),Ae=c.a.useCallback((function(e){var t=e.target.value;te(t),l.a.setAudioOutputDevice(t),K(t)}),[K,te]),Re=function(){console.log("validateForm",be),console.log("validateForm",se),(""===be?(xe(!0),0):""!==se||(he(!0),0))&&(localStorage.setItem("username",be),localStorage.setItem("specialty",ce),i("room/".concat(se)))},Pe=function(e){13===e.keyCode&&Re()};return Object(a.useEffect)((function(){var e={publishAudio:r,publishVideo:s};Ce.current&&ke(Ce.current.id,e)}),[ke,r,s]),Object(a.useEffect)((function(){Se&&Se.publishAudio(v)}),[v,Se]),Object(a.useEffect)((function(){Se&&Se.publishVideo(S)}),[S,Se]),Object(a.useEffect)((function(){if(Se&&we&&Ie){var e=Se.getAudioSource();G(Y(Ie.audioInputDevices,e));var t=Se.getVideoSource();X(Y(Ie.videoInputDevices,null===t||void 0===t?void 0:t.track)),l.a.getActiveAudioOutputDevice().then((function(e){te(e.deviceId)}))}}),[Ie,Se,G,X,te,we]),Object(a.useEffect)((function(){n({defaultSettings:{publishAudio:v,publishVideo:S,audioSource:M,videoSource:N,audioOutput:L}})}),[v,S,n,M,N,L]),Object(R.jsxs)("div",{className:e.waitingRoomContainer,children:[Object(R.jsx)("div",{className:e.containerCenter,children:Object(R.jsxs)("div",{className:e.waitingRoomVideoPreview,children:[Object(R.jsxs)("form",{className:e.form,noValidate:!0,children:[Object(R.jsxs)(d.a,{fullWidth:!0,children:[Object(R.jsx)(b.a,{id:"specialty-select-label",children:"Medical Specialty"}),Object(R.jsx)(j.a,{size:"small",labelId:"specialty-select-label",id:"specialty-select",name:"specialty",value:ce,onChange:function(e){return ie(e.target.value)},children:["PRIMARYCARE","CARDIOLOGY","NEUROLOGY","ONCOLOGY","RADIOLOGY","UROLOGY"].map((function(e,t){return Object(R.jsx)(f.a,{value:e,children:e},t)}))})]}),Object(R.jsx)(O.a,{size:"small",variant:"outlined",margin:"dense",required:!0,fullWidth:!0,id:"room-name",label:"Room Name",name:"roomName",autoComplete:"Room Name",error:pe,autoFocus:!0,value:se,onChange:function(e){var t=e.target.value;""!==t&&""!==t.trim()?(he(!1),le(t)):le("")},onKeyDown:Pe}),Object(R.jsx)(O.a,{size:"small",variant:"outlined",margin:"none",fullWidth:!0,id:"publisher-name",label:"Name",name:"name",error:ve,required:!0,autoComplete:"Name",value:be,onChange:function(e){var t=e.target.value;""!==t&&""!==t.trim()?(xe(!1),je(t)):je("")},onKeyDown:Pe})]}),Object(R.jsx)("div",{className:e.deviceContainer,children:Object(R.jsxs)(R.Fragment,{children:[Object(R.jsxs)(d.a,{margin:"dense",children:[Object(R.jsx)(b.a,{id:"demo-simple-select-label",children:"Select Audio Source"}),Object(R.jsx)(j.a,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:U,onChange:Te,autoWidth:!0,children:Ie.audioInputDevices.map((function(e){return Object(R.jsx)(f.a,{value:e.deviceId,children:e.label},e.deviceId)}))})]}),Object(R.jsxs)(d.a,{margin:"dense",children:[Object(R.jsx)(b.a,{id:"video",children:"Select Audio Output"}),Ie.audioOutputDevices&&Object(R.jsx)(j.a,{labelId:"video",id:"demo-simple-select",value:ee,onChange:Ae,autoWidth:!0,children:Ie.audioOutputDevices.map((function(e){return Object(R.jsx)(f.a,{value:e.deviceId,children:e.label},e.deviceId)}))})]}),Object(R.jsxs)(d.a,{margin:"dense",children:[Object(R.jsx)(b.a,{id:"video",children:"Select Video Source"}),Ie.videoInputDevices&&Object(R.jsx)(j.a,{labelId:"video",id:"demo-simple-select",value:Q,onChange:De,autoWidth:!0,children:Ie.videoInputDevices.map((function(e){return Object(R.jsx)(f.a,{value:e.deviceId,children:e.label},e.deviceId)}))})]})]})}),Object(R.jsxs)("div",{className:e.deviceContainer,children:[Object(R.jsx)(P,{className:e.deviceSettings,hasAudio:v,onAudioChange:Ne}),Object(R.jsx)(B,{className:e.deviceSettings,hasVideo:S,onVideoChange:Ee})]}),Object(R.jsx)("div",{id:"waiting-room-video-container",className:e.waitingRoomVideoContainer,ref:Ce})]})}),Object(R.jsx)("div",{className:e.containerCenter,children:Object(R.jsx)(p.a,{variant:"contained",color:"secondary",onClick:Re,children:"Join Call"})})]})}var J=n(20);n(258);function U(e){var t=e.container,n=Object(a.useState)(!1),i=Object(o.a)(n,2),r=i[0],s=i[1],u=Object(a.useState)([]),d=Object(o.a)(u,2),b=d[0],j=d[1],f=Object(a.useRef)(null),O=Object(a.useState)(null),p=Object(o.a)(O,2),h=p[0],m=p[1],g=function(e){return"EC"!==e},v=c.a.useCallback((function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(console.log(e),f.current&&t.current){var a=Object.assign({},n,{insertMode:"append",width:"100%",height:"100%",fitMode:"contain",style:{buttonDisplayMode:"on",nameDisplayMode:"on"},showControls:!0,subscribeToVideo:g(e.name),subscribeToAudio:g(e.name)});f.current.subscribe(e,g(e.name)?t.current.id:null,a)}}),[t]),x=Object(a.useCallback)((function(e){console.log("stream created event "+e.stream.name),console.log(" subscribe to video "+g(e.stream.name)),console.log("is experience composer "+("virtualviewer"===window.location.pathname.split("/")[2])),v(e.stream),function(e){var t=e.stream;j((function(e){return[].concat(Object(J.a)(e),[t])}))}({stream:e.stream})}),[v]),C=Object(a.useCallback)((function(e){!function(e){var t=e.stream;j((function(e){return e.filter((function(e){return e.id!==t.id}))}))}({stream:e.stream})}),[]),y=Object(a.useCallback)((function(e){m("disconnected")}),[]),S=Object(a.useCallback)((function(e){m("reconnecting")}),[]),k=Object(a.useCallback)((function(e){console.log(e),t.current&&(t.current=null)}),[t]),I=Object(a.useCallback)((function(e){var t=e.apiKey,n=e.sessionId,a=e.token;if(!t)throw new Error("Missing apiKey");if(!n)throw new Error("Missing sessionId");if(!a)throw new Error("Missing token");f.current=l.a.initSession(t,n,{});var c={streamCreated:x,streamDestroyed:C,sessionReconnecting:S,sessionDisconnected:y,connectionDestoyed:k};return f.current.on(c),new Promise((function(e,t){f.current.connect(a,(function(n){f.current&&(n?t(n):n||(console.log("Session Connected!"),s(!0),e(f.current)))}))}))}),[k,y,S,x,C]),w=c.a.useCallback((function(){f.current&&(f.current.on("disconnected",(function(){f.current=null})),f.current.disconnect())}),[]);return{session:f,connected:r,createSession:I,destroySession:w,streams:b,status:h}}var G=n(161),H=n.n(G),q=n(160),Q=n.n(q),X=n(337),Z=n(370),$=Object(F.a)({selected:{color:"#b779ff"}});function ee(e){e.toggleAudio;var t=e.hasAudio,n=e.classes,a=e.handleAudioChange,c=t?"Disable Microphone":"Enable Microphone";$();return Object(R.jsx)(R.Fragment,{children:Object(R.jsx)(Z.a,{title:c,"aria-label":"add",children:Object(R.jsx)(X.a,{edge:"start",color:"inherit","aria-label":"mic",onClick:a,className:"".concat(n.toolbarButtons," ").concat(t?"":n.disabledButton,"\n          "),children:t?Object(R.jsx)(H.a,{fontSize:"large"}):Object(R.jsx)(Q.a,{fontSize:"large"})})})})}var te=n(163),ne=n.n(te),ae=n(162),ce=n.n(ae),ie=Object(F.a)({selected:{color:"#b779ff",backgroundColor:"black"}});function re(e){var t=e.classes,n=e.hasVideo,a=e.handleVideoChange,i=n?"Disable Camera":"Enable Camera",r=c.a.useState(null),s=Object(o.a)(r,2),l=(s[0],s[1],c.a.useState([])),u=Object(o.a)(l,2),d=(u[0],u[1],c.a.useState(!1)),b=Object(o.a)(d,2),j=(b[0],b[1],c.a.useRef(null),c.a.useState(0)),f=Object(o.a)(j,2);f[0],f[1],ie();return Object(R.jsx)(R.Fragment,{children:Object(R.jsx)(Z.a,{title:i,"aria-label":"add",children:Object(R.jsx)(X.a,{onClick:a,edge:"start","aria-label":"videoCamera",size:"small",className:"".concat(t.arrowButton," ").concat(n?"":t.disabledButton),children:n?Object(R.jsx)(ne.a,{fontSize:"large"}):Object(R.jsx)(ce.a,{fontSize:"large"})})})})}var oe=n(58);function se(e){var t=e.session,n=Object(a.useState)(null),c=Object(o.a)(n,2),i=c[0],r=c[1],s=Object(a.useState)(null),l=Object(o.a)(s,2),u=(l[0],l[1],Object(a.useState)(null)),d=Object(o.a)(u,2),b=d[0],j=d[1],f=Object(a.useState)(null),O=Object(o.a)(f,2),p=O[0],h=O[1],m=Object(a.useState)([]),g=Object(o.a)(m,2),v=g[0],x=g[1],C=Object(a.useState)([]),k=Object(o.a)(C,2),I=k[0],w=k[1],N=Object(a.useState)([]),E=Object(o.a)(N,2),D=E[0],T=E[1],A=Object(a.useState)([]),R=Object(o.a)(A,2),P=R[0],M=R[1],V=Object(a.useState)([]),B=Object(o.a)(V,2),F=B[0],z=B[1],L=Object(a.useCallback)(function(){var e=Object(S.a)(Object(y.a)().mark((function e(n){var a,c;return Object(y.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.type,c=n.data,e.abrupt("return",new Promise((function(e,n){var i=JSON.parse(JSON.stringify({type:a,data:c}));t&&t.signal(i,(function(t){t?n(t):e()}))})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[t]),K=Object(a.useCallback)((function(e){var t=e.data;console.log(t);var n=t.split(":")[0],a=t.split(":")[1];j(n),h(a)}),[]),W=Object(a.useCallback)((function(e){return L({type:"message",data:e})}),[L]),Y=Object(a.useCallback)((function(e){var t=e.data,n=(e.from,JSON.parse(t));n.length&&n.forEach((function(e){"MEDICATION"===(null===e||void 0===e?void 0:e.Category)&&x((function(t){return[{Text:"".concat(e.Text," | ").concat(Math.floor(1e4*e.Score)/100,"%"),concepts:e.RxNormConcepts?e.RxNormConcepts:[]}].concat(Object(J.a)(t))}))}))}),[]),_=Object(a.useCallback)((function(e){var t=e.data,n=(e.from,JSON.parse(t));n.length&&n.forEach((function(e){"MEDICAL_CONDITION"===(null===e||void 0===e?void 0:e.Category)&&w((function(t){return[{Text:"".concat(e.Text," | ").concat(Math.floor(1e4*e.Score)/100,"%"),concepts:e.ICD10CMConcepts?e.ICD10CMConcepts:[]}].concat(Object(J.a)(t))}))}))}),[]),U=Object(a.useCallback)((function(e){var t=e.data,n=(e.from,JSON.parse(t));n.length&&n.forEach((function(e){if("ANATOMY"===(null===e||void 0===e?void 0:e.Category)&&T((function(t){return[{Text:"".concat(e.Type," | ").concat(e.Text)}].concat(Object(J.a)(t))})),"PROTECTED_HEALTH_INFORMATION"===(null===e||void 0===e?void 0:e.Category)&&M((function(t){return[{Text:"".concat(e.Type," | ").concat(e.Text)}].concat(Object(J.a)(t))})),"TEST_TREATMENT_PROCEDURE"===(null===e||void 0===e?void 0:e.Category)){var t=e.Attributes&&e.Attributes[0]?" | "+e.Attributes[0].Text:"";z((function(n){return[{Text:e.Text+t}].concat(Object(J.a)(n))}))}}))}),[]),G=Object(a.useCallback)((function(e){var t=e.data;e.from;console.log("received message"),console.log(JSON.stringify(t)),r(t)}),[]);return Object(a.useEffect)((function(){return t&&(t.on("signal:captions",G),t.on("signal:medicalEntities",U),t.on("signal:archiveStarted",K),t.on("signal:medication",Y),t.on("signal:medCondition",_)),function(){t&&(t.off("signal:captions",G),t.off("signal:archiveStarted",K),t.off("signal:medicalEntities",U),t.off("signal:medication",Y),t.off("signal:medCondition",Y))}}),[t,G,K,U,Y,_]),{sendMessage:W,messages:i,archiveId:b,renderedSesion:p,medicalConditions:I,medication:v,piiEntities:P,anatomyEntities:D,ttpEntities:F}}var le=n(124),ue=n.n(le),de=Object(F.a)((function(e){return{activeRecordingIcon:{boxShadow:"0 0 0 0 rgba(213, 15, 45, 1)",animation:"pulse-red 2s infinite",borderRadius:"100%"}}})),be=n(356);function je(e){var t=e.classes,n=e.session,c=Object(a.useContext)(h),i=c.preferences,r=c.setPreferences,s=Object(u.h)().roomName,l=se({session:n}).archiveId,d=Object(a.useState)(!1),b=Object(o.a)(d,2),j=b[0],f=b[1],O=Object(a.useState)(null),p=Object(o.a)(O,2),m=p[0],k=p[1],I=Object(a.useState)(null),w=Object(o.a)(I,2),N=w[0],E=w[1],D=de(),T=function(){var e=Object(S.a)(Object(y.a)().mark((function e(t){var n,a,c,r;return Object(y.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!j){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,x(t);case 5:if(!((n=e.sent).status=n.data)){e.next=14;break}a=n.data,c=a.id,r=a.sessionId,i.renderId=c,i.sessionId=r,k(c),E(r),e.next=15;break;case 14:return e.abrupt("return");case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(2),console.log(e.t0);case 20:case"end":return e.stop()}}),e,null,[[2,17]])})));return function(t){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){console.log("run preferences hook"),m===i.renderId&&l===i.archiveId&&N===i.sessionId||m&&r(Object(oe.a)(Object(oe.a)({},i),{},{renderId:m,archiveId:l,sessionId:N}))}),[m,r,l,i,N]),Object(a.useEffect)((function(){i.recording!==j&&r(Object(oe.a)(Object(oe.a)({},i),{},{recording:j}))}),[j,i,r]);var A=function(){var e=Object(S.a)(Object(y.a)().mark((function e(t){var n;return Object(y.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=19;break}return e.prev=1,e.next=4,a=t,g.a.get("".concat(v,"/render/stop/").concat(a));case 4:if(n=e.sent,console.log(n),!(n.status=200)){e.next=11;break}P(l),k(null),e.next=12;break;case 11:return e.abrupt("return");case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),console.log(e.t0);case 17:e.next=20;break;case 19:return e.abrupt("return");case 20:case"end":return e.stop()}var a}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){n&&(n.on("archiveStarted",(function(){f(!0)})),n.on("archiveStopped",(function(){f(!1)})))}));var P=function(){var e=Object(S.a)(Object(y.a)().mark((function e(t){var n;return Object(y.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!j||!t){e.next=7;break}return e.next=4,C(t);case 4:n=e.sent,console.log(n),200===n.status&&n.data&&(n.data.status,f(!1));case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),M=j?"Stop Recording":"Start Recording";return Object(R.jsx)(be.a,{title:M,"aria-label":"add",children:Object(R.jsx)(X.a,{"aria-label":"record",onClick:function(){console.log("trying to start recording"),j?A(m):T(s)},className:t.toolbarButtons,children:j?Object(R.jsx)(ue.a,{fontSize:"large",className:D.activeRecordingIcon,style:{color:"#D50F2C"}}):Object(R.jsx)(ue.a,{fontSize:"large"})})})}var fe=n(167),Oe=n.n(fe);function pe(e){var t=e.classes,n=e.handleEndCall;return Object(R.jsx)(Z.a,{title:"End call","aria-label":"add",children:Object(R.jsx)(X.a,{edge:"start",color:"inherit","aria-label":"videoCamera",className:t.toolbarButtons,style:{backgroundColor:"#D50F2C"},onClick:n,children:Object(R.jsx)(Oe.a,{fontSize:"inherit"})})})}var he=Object(F.a)((function(e){return{toolbarContainer:{backgroundColor:e.palette.toolbarBackground.main,display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",bottom:0,left:0,right:0,height:"90px",borderRadius:"18px"},paper:{position:"absolute",display:"flex",width:400,backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)},toolbarMobileContainer:{backgroundColor:e.palette.toolbarBackground.main,display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",bottom:0,left:0,right:0,height:"60px",margin:e.spacing(2),borderRadius:"25px"},toolbarButtons:{margin:e.spacing(1),borderRadius:"5em",backgroundColor:"#32353A",color:"#fff"},arrowButton:{borderRadius:"5em",height:"50px",width:"50px",backgroundColor:"#32353A",color:"#fff"},infoButton:{position:"absolute",left:"0",margin:e.spacing(1),borderRadius:"5em",height:"50px",width:"50px",backgroundColor:"#32353A",color:"#fff"},groupButton:{margin:"8px"},disabledButton:{backgroundColor:e.palette.activeButtons.red,"&:hover":{backgroundColor:e.palette.activeButtons.red}},activeButton:{backgroundColor:e.palette.activeButtons.green,"&:hover":{backgroundColor:e.palette.activeButtons.green}},activeButtonIcon:{color:e.palette.activeButtons.green}}}));var me=function(e){var t=e.session,n=e.handleVideoChange,a=e.handleAudioChange,i=e.hasVideo,r=e.hasAudio,o=e.publisher,s=he(),l=Object(u.g)().push,d=Object(u.h)().roomName,b=(se({session:t}).renderedSesion,c.a.useContext(h).preferences);return Object(R.jsxs)("div",{className:"toolbar",children:[Object(R.jsx)(ee,{classes:s,handleAudioChange:a,hasAudio:r}),Object(R.jsx)(re,{classes:s,handleVideoChange:n,hasVideo:i}),Object(R.jsx)(je,{classes:s,session:t}),Object(R.jsx)(pe,{classes:s,handleEndCall:function(){o&&l("/mta/".concat(d,"/").concat(b.sessionId,"/end"))}})]})};Object(F.a)({root:{top:"0",background:function(e){var t=e.wsStatus;return"disconnected"===t||"reconnecting"===t?"#f19c38":"reconnected"===t?"#4caf50":void 0},justifyContent:"center"},info:{top:"0",background:"#418be9",justifyContent:"center"},action:{position:"absolute",right:"0",paddingRight:"10px"},networkStatusIcons:{paddingRight:"10px"},snackBarContent:{display:"flex",alignItems:"flex-end",fontSize:"14px"}}),n(168),n(363);var ge=n(369),ve=n(360),xe=n(349),Ce=n(350),ye=n(366),Se=n(357),ke=n(362),Ie=n(169),we=n.n(Ie),Ne=n(172),Ee=n.n(Ne),De=n(170),Te=n.n(De),Ae=n(171),Re=n.n(Ae),Pe=n(112),Me=n(173),Ve=n.n(Me),Be=n(174),Fe=n.n(Be);var ze=function(e){var t=e.listOfEntities,n=e.entity;return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(ge.a,{children:Object(R.jsxs)(ve.a,{disablePadding:!0,children:[Object(R.jsx)(xe.a,{children:function(e){switch(e){case"Medical Condition":return Object(R.jsx)(we.a,{});case"Medication":return Object(R.jsx)(Te.a,{});case"Anatomy":return Object(R.jsx)(Re.a,{});case"Treatments":return Object(R.jsx)(Ee.a,{});case"PII":return Object(R.jsx)(Ve.a,{});case"Test Treatment Procedures":return Object(R.jsx)(Fe.a,{});default:return}}(n)}),Object(R.jsx)(Pe.a,{style:{background:function(e){switch(e){case"Medical Condition":return"#5cceff";case"Medication":return"#f0e442";case"Anatomy":return"#d185af";case"Treatments":case"Test Treatment Procedures":return"#4a9";case"PII":return"#999";default:return}}(n),padding:"0px"},variant:"div",component:"div",gutterBottom:!0,children:n})]},n)}),Object(R.jsx)(ge.a,{sx:{pl:2,display:"flex",flexDirection:"column",maxHeight:100,overflow:"hidden",overflowY:"scroll",bgcolor:"background.paper"},children:t?t.map((function(e,t){return Object(R.jsxs)("div",{children:[Object(R.jsx)(ve.a,{disablePadding:!0,children:Object(R.jsx)(Ce.a,{primary:e.Text})}),Object(R.jsx)(ye.a,{in:!0,timeout:"auto",unmountOnExit:!0,sx:{pl:2},children:Object(R.jsx)(ge.a,{component:"div",disablePadding:!0,children:e.concepts&&e.concepts.length>0?Object(R.jsx)(Se.a,{value:"0",size:"small",children:e.concepts.map((function(e,n){return Object(R.jsx)(ke.a,{value:n,children:"".concat(e.Code," | ").concat(e.Description," | ").concat(Math.floor(1e4*e.Score)/100,"%")},"item-".concat(t,"-").concat(n))}))}):""})})]},"".concat(e.Text,"-").concat(t))})):""})]})};var Le=function(){var e=Object(a.useRef)(),t=Object(u.h)().roomName,n=(Object(a.useContext)(h).preferences,Object(a.useState)({text:"Say something...",speaker:""})),c=Object(o.a)(n,2),i=c[0],r=c[1],s=Object(a.useState)(null),l=Object(o.a)(s,2),d=l[0],b=l[1],j=Object(a.useState)(null),f=Object(o.a)(j,2),O=(f[0],f[1]),p=Object(a.useState)(!0),m=Object(o.a)(p,2),g=m[0],v=m[1],x=Object(a.useState)(!0),C=Object(o.a)(x,2),y=C[0],S=C[1],k=Object(a.useState)(null),w=Object(o.a)(k,2),N=(w[0],w[1]),D=U({container:e}),T=D.session,A=D.createSession,P=D.connected,M=(D.status,D.destroySession,se({session:T.current})),V=M.messages,B=(M.sendMessage,M.medication),F=M.medicalConditions,z=M.piiEntities,L=M.anatomyEntities,K=M.ttpEntities,W=E(),Y=W.publisher,_=W.publish,J=W.pubInitialised;W.isPublishing,W.publisherError,W.destroyPublisher,W.unpublish,Object(a.useEffect)((function(){r(V)}),[V]),Object(a.useEffect)((function(){I(t).then((function(e){var t=e.data;console.log("Credential data: ",t),b({apiKey:t.apiKey,sessionId:t.sessionId,token:t.token}),N(t.userId)})).catch((function(e){O(e),console.log(e)}))}),[t]),Object(a.useEffect)((function(){if(d){var e=d.apiKey,t=d.sessionId,n=d.token;console.log(e),A({apiKey:e,sessionId:t,token:n})}}),[A,d]);var G=Object(a.useCallback)((function(){g?(Y.publishAudio(!1),v(!1)):(Y.publishAudio(!0),v(!0))}),[g,Y]),H=Object(a.useCallback)((function(){y?(Y.publishVideo(!1),S(!1)):(Y.publishVideo(!0),S(!0))}),[y,Y]);return Object(a.useEffect)((function(){T.current&&P&&!J&&e.current&&_({session:T.current,containerId:e.current.id})}),[_,T,P,J]),Object(R.jsxs)(R.Fragment,{children:[Object(R.jsxs)("div",{className:"videoContainer",children:[Object(R.jsx)("div",{className:"video",ref:e,id:"video-container"}),Object(R.jsxs)("div",{className:"medicalAnalysis",sx:{display:"flex",flexDirection:"column",maxHeight:820,overflow:"hidden",overflowY:"scroll"},children:[Object(R.jsx)("div",{className:"entityType",children:Object(R.jsx)(ze,{listOfEntities:F,entity:"Medical Condition"})}),Object(R.jsx)("div",{className:"entityType",children:Object(R.jsx)(ze,{listOfEntities:B,entity:"Medication"})}),Object(R.jsx)("div",{className:"entityType",children:Object(R.jsx)(ze,{listOfEntities:L,entity:"Anatomy"})}),Object(R.jsx)("div",{className:"entityType",children:Object(R.jsx)(ze,{listOfEntities:z,entity:"PII"})}),Object(R.jsx)("div",{className:"entityType",children:Object(R.jsx)(ze,{listOfEntities:K,entity:"Test Treatment Procedures"})})]})]}),Object(R.jsx)("div",{className:"original",children:i?"".concat(i.speaker,": ").concat(i.text):""}),Object(R.jsx)(me,{handleAudioChange:G,handleVideoChange:H,session:T.current,hasAudio:g,hasVideo:y,publisher:Y})]})},Ke=Object(F.a)({flex:{height:"100vh",display:"flex",flexDirection:"column",flexWrap:"nowrap",justifyContent:"flex-start",alignContent:"stretch",alignItems:"flex-start"}});var We=function(){var e=Ke();return Object(R.jsx)("div",{className:e.flex,children:Object(R.jsx)(Le,{})})},Ye=n(176),_e=n.n(Ye),Je=n(352),Ue=n(354),Ge=n(353),He=n(4),qe=Object(F.a)((function(e){var t;return{banner:{zIndex:1,margin:"200px",height:"100px",width:"50%",alignItems:"center",borderRadius:"30px",backgroundColor:"black"},container:(t={},Object(He.a)(t,"@media (min-width:768px)",{marginTop:10,display:"flex",flexDirection:"row"}),Object(He.a)(t,"display","flex"),Object(He.a)(t,"flexDirection","column"),Object(He.a)(t,"alignItems","center"),Object(He.a)(t,"alignContent","center"),t),new__meeting:{color:"rgb(43,158,250)"},meetingInfo:{margin:"100px",width:"50%",height:"100px",color:"white"},recording:{display:"flex",flexDirection:"row",margin:"5px",padding:"5px"},root:{minWidth:275,margin:"auto"},bullet:{display:"inline-block",margin:"0 2px",transform:"scale(0.8)"},title:{fontSize:14},pos:{marginBottom:12},centeredFlex:{justifyContent:"center",display:"flex",flexDirection:"column",alignItems:"center",backgroundColor:"black",color:"white",borderRadius:"30px"}}}));function Qe(){var e=Object(u.g)().push,t=Object(a.useState)(null),n=Object(o.a)(t,2),c=n[0],i=n[1],r=qe(),s=Object(u.h)().sessionId,l=E().destroyPublisher;return Object(a.useEffect)((function(){l(),console.log(s),function(e){return g.a.get("".concat(v,"/archive/").concat(e))}(s).then((function(e){e.data&&i(e.data)})).catch((function(e){console.log(e),i(null)}))}),[s,l]),Object(a.useEffect)((function(){setTimeout((function(){window.OT.publishers.map((function(e){return e}))[0].destroy()}),3e3)})),Object(R.jsxs)("div",{className:r.container,children:[Object(R.jsxs)("div",{className:r.meetingInfo,children:[Object(R.jsx)("h2",{style:{color:"white"},children:"We hope you enjoyed your meeting"}),Object(R.jsx)("h2",{style:{color:"white"},children:"This was powered by Vonage"}),Object(R.jsx)(X.a,{onClick:function(){e("/")},className:r.new__meeting,children:"Start new meeting"})]}),Object(R.jsx)("div",{className:r.banner,children:Object(R.jsxs)(Je.a,{className:r.centeredFlex,variant:"outlined",children:[Object(R.jsx)(Ge.a,{children:c&&c.length?Object(R.jsx)("h3",{style:{color:"white"},children:"Recordings"}):Object(R.jsx)("h3",{children:"There are no recordings"})}),Object(R.jsx)(Ue.a,{children:Object(R.jsx)("div",{className:r.root,children:c?Object(R.jsx)("div",{className:r.recording,children:Object(R.jsx)("ul",{children:c.map((function(e){return Object(R.jsxs)("li",{children:["Started at: ",Date(e.createdAt),"available"===e.status?Object(R.jsx)(p.a,{color:"inherit",edge:"start",target:"_blank",href:e.url,children:Object(R.jsx)(_e.a,{})}):null]},e.id)}))})}):null})})]})})]})}var Xe=n(177),Ze=n(355),$e=n(7),et=["component"],tt=function(e){var t,n,c=e.component,i=Object($e.a)(e,et),r=(Object(a.useContext)(h).preferences,null===i||void 0===i||null===(t=i.computedMatch)||void 0===t||null===(n=t.params)||void 0===n?void 0:n.roomName);return Object(R.jsx)(u.b,Object(oe.a)(Object(oe.a)({},i),{},{render:function(e){return r?Object(R.jsx)(c,Object(oe.a)({},e)):Object(R.jsx)(u.a,{to:{pathname:"/"}})}}))};Object(F.a)((function(e){return{header:{flex:"0.5 1 auto",alignSelf:"stretch",margin:"auto",padding:"15px 30px",display:"flex",background:"linear-gradient(to right, #8728fb, #fea18c) !important",color:"#fff",width:"100%",alignItems:"center"}}}));var nt=Object(F.a)({flex:{height:"100vh",display:"flex",flexDirection:"column",flexWrap:"nowrap",justifyContent:"flex-start",alignContent:"stretch",alignItems:"flex-start"}});var at=function(){var e=Object(a.useState)(null),t=Object(o.a)(e,2),n=t[0],c=t[1],i=Object(a.useRef)(),r=Object(u.h)().roomName,s=(Object(a.useContext)(h).preferences,Object(a.useState)({text:"Say something...",speaker:""})),l=Object(o.a)(s,2),d=l[0],b=l[1],j=U({container:i}),f=j.session,O=j.createSession,p=(j.connected,j.streams,se({session:f.current})),m=p.messages,g=(p.sendMessage,p.medication),v=p.medicalConditions,x=p.piiEntities,C=p.anatomyEntities,y=p.ttpEntities;return Object(a.useEffect)((function(){w(r).then((function(e){var t=e.data;c({apiKey:t.apiKey,sessionId:t.sessionId,token:t.token}),setUserId(t.userId)})).catch((function(e){console.log(e)}))}),[r]),Object(a.useEffect)((function(){if(n){var e=n.apiKey,t=n.sessionId,a=n.token;console.log(e),O({apiKey:e,sessionId:t,token:a})}}),[O,n]),Object(a.useEffect)((function(){b(m)}),[m]),nt(),Object(R.jsxs)(R.Fragment,{children:[Object(R.jsxs)("div",{className:"videoContainer",children:[Object(R.jsx)("div",{className:"video",ref:i,id:"video-container"}),Object(R.jsxs)("div",{className:"medicalAnalysis",sx:{display:"flex",flexDirection:"column",maxHeight:820,overflow:"hidden",overflowY:"scroll"},children:[Object(R.jsx)("div",{className:"entityType",children:Object(R.jsx)(ze,{listOfEntities:v,entity:"Medical Condition"})}),Object(R.jsx)("div",{className:"entityType",children:Object(R.jsx)(ze,{listOfEntities:g,entity:"Medication"})}),Object(R.jsx)("div",{className:"entityType",children:Object(R.jsx)(ze,{listOfEntities:C,entity:"Anatomy"})}),Object(R.jsx)("div",{className:"entityType",children:Object(R.jsx)(ze,{listOfEntities:x,entity:"PII"})}),Object(R.jsx)("div",{className:"entityType",children:Object(R.jsx)(ze,{listOfEntities:y,entity:"Test Treatment Procedures"})})]})]}),Object(R.jsx)("div",{className:"captionsComposer",children:d?"".concat(d.speaker,": ").concat(d.text):""})]})},ct=n(70);var it=function(){var e=Object(a.useState)({name:null,defaultSettings:{}}),t=Object(o.a)(e,2),n=t[0],c=t[1],i=Object(a.useMemo)((function(){return{preferences:n,setPreferences:c}}),[n,c]);return Object(R.jsx)(Ze.a,{theme:Object(Xe.a)({palette:{type:"light",primary:{main:"#b779ff"},secondary:{main:"#d6219c"},bodyBackground:{black:"#131415"},callBackground:{main:"#20262D"},toolbarBackground:{main:"#41464D"},activeButtons:{green:"#1C8731",red:"#D50F2C"}}}),children:Object(R.jsx)(ct.a,{children:Object(R.jsx)(h.Provider,{value:i,children:Object(R.jsxs)(u.d,{children:[Object(R.jsx)(u.b,{exact:!0,path:"/mta/:roomName/:sessionId/end",children:Object(R.jsx)(Qe,{})}),Object(R.jsx)(tt,{exact:!0,path:"/room/:roomName",component:We}),Object(R.jsx)(u.b,{path:"/videorti/recorder/:roomName",children:Object(R.jsx)(at,{})}),Object(R.jsx)(u.b,{path:"/",children:Object(R.jsx)(_,{})}),Object(R.jsx)(u.b,{path:"*",children:Object(R.jsx)(u.a,{to:{pathname:"/"}})})]})})})})},rt=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,374)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,i=t.getLCP,r=t.getTTFB;n(e),a(e),c(e),i(e),r(e)}))};r.a.render(Object(R.jsx)(c.a.StrictMode,{children:Object(R.jsx)(it,{})}),document.getElementById("root")),rt()}},[[261,1,2]]]);
//# sourceMappingURL=main.9ab9a65d.chunk.js.map