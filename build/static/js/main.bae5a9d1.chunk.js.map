{"version":3,"sources":["logo.svg","context/UserContext.js","api/fetchRecording.js","api/fetchCreds.js","hooks/usePublisher.js","hooks/useDevices.js","components/AudioSetting/index.js","components/VideoSetting/index.js","components/WaitingRoom/styles.js","utils/index.js","components/WaitingRoom/index.js","hooks/useSession.js","components/MuteAudioButton/styles.js","components/MuteAudioButton/index.js","components/MuteVideoButton/styles.js","components/MuteVideoButton/index.js","hooks/useSignalling.js","components/RecordButton/styles.js","components/RecordButton/index.js","components/EndCallButton/index.js","components/ToolBar/styles.js","components/ToolBar/index.js","components/Banner/styles.js","components/EntitiesList/index.js","components/Main/index.js","components/Wrapper/styles.js","components/Wrapper/index.js","components/EndCall/styles.js","components/EndCall/index.js","components/ProtectedRoute/index.js","components/Header/styles.js","components/VirtualView/styles.js","components/VirtualView/index.js","App.js","reportWebVitals.js","index.js"],"names":["UserContext","createContext","API_URL","process","render","roomName","axios","post","stopRender","id","get","stopRecording","archiveId","console","log","getCredentials","startTranslation","streamId","sessionId","specialty","usePublisher","useParams","preferences","useContext","useState","isPublishing","setIsPublishing","pubInitialised","setPubInitialised","publisherRef","useRef","publisherError","setPublisherError","connectionIdFromStream","setConnectionIdFromStreamer","setSessionId","audioInputDevices","videoInputDevices","audioOutputDevices","deviceInfo","setDeviceInfo","getDevices","useCallback","navigator","mediaDevices","enumerateDevices","warn","Promise","resolve","reject","OT","err","devices","getAudioOutputDevices","map","audiooutput","deviceId","label","filter","d","kind","toLowerCase","useEffect","addEventListener","removeEventListener","useDevices","streamCreatedListener","React","stream","publisher","session","localStorage","getItem","then","data","connectionId","catch","e","streamDestroyedListener","current","initPublisher","containerId","publisherOptions","finalPublisherOptions","Object","assign","width","height","name","publishVideo","publishAudio","style","buttonDisplayMode","nameDisplayMode","insertMode","showControls","fitMode","on","destroyPublisher","destroy","renderId","publish","unpublish","AudioSettings","memo","hasAudio","onAudioChange","className","Switch","checked","onChange","VideoSettings","hasVideo","onVideoChange","makeStyles","theme","waitingRoomContainer","position","left","top","display","flexDirection","transform","backgroundColor","blueGrey","padding","borderRadius","waitingRoomVideoContainer","deviceContainer","margin","deviceSettings","justifyContent","alignItems","selectWidth","networkTestContainer","flex","green","color","red","containerCenter","getSourceDeviceId","inputDevices","currentSource","toReturn","i","length","WaitingRoom","classes","useStyles","setPreferences","push","useHistory","defaultLocalAudio","defaultLocalVideo","localAudio","setLocalAudio","localVideo","setLocalVideo","undefined","localVideoSource","setLocalVideoSource","localAudioSource","setLocalAudioSource","localAudioOutput","setLocalAudioOutput","audioDevice","setAudioDevice","videoDevice","setVideoDevice","audioOutputDevice","setAudioOutputDevice","setSpecialty","setRoomName","userName","setUserName","isRoomNameInvalid","setIsRoomNameInvalid","isUserNameInvalid","setIsUserNameInvalid","handleAudioChange","target","handleVideoChange","handleVideoSource","videoDeviceId","value","setVideoSource","handleAudioSource","audioDeviceId","setAudioSource","handleAudioOutput","audioOutputId","handleJoinClick","setItem","onKeyDown","keyCode","currentAudioDevice","getAudioSource","currentVideoDevice","getVideoSource","track","getActiveAudioOutputDevice","currentAudioOutputDevice","defaultSettings","audioSource","videoSource","audioOutput","waitingRoomVideoPreview","form","noValidate","FormControl","fullWidth","InputLabel","Select","size","labelId","key","MenuItem","TextField","variant","required","autoComplete","error","autoFocus","trim","autoWidth","device","ref","Button","onClick","useSession","container","connected","setConnected","streams","setStreams","sessionRef","status","setNetworkStatus","isExperienceComposer","window","location","pathname","split","shouldSubscribeToVideo","shouldSubscribeToAudio","subscribe","options","finalOptions","subscribeToVideo","subscribeToAudio","onStreamCreated","event","prev","addStream","onStreamDestroyed","prevStream","removeStream","onSessionDisconnected","onSessionReconnecting","onConnectionDestroyed","createSession","apiKey","token","Error","initSession","eventHandlers","streamCreated","streamDestroyed","sessionReconnecting","sessionDisconnected","connectionDestoyed","connect","destroySession","disconnect","selected","MuteAudioButton","toggleAudio","title","styles","Tooltip","IconButton","edge","toolbarButtons","disabledButton","fontSize","MuteVideoButton","arrowButton","useSignalling","messages","setMessages","setArchiveId","renderedSesion","setRenderedSession","medication","setMedicationEntities","medicalConditions","setMedicalConditionsEntities","anatomyEntities","setAnatomyEntities","piiEntities","setPiiEntities","signal","type","payload","JSON","parse","stringify","archiveListener","sessionRendered","sendMessage","message","medicationListener","dataJson","from","forEach","entity","Text","Score","concepts","RxNormConcepts","medConditionListener","ICD10CMConcepts","entitiesListener","Category","messageListener","off","activeRecordingIcon","boxShadow","animation","RecordingButton","isRecording","setRecording","setRenderId","localClasses","startRender","renderData","recording","stopRenderAndRecording","handleRecordingStop","EndCallIcon","handleEndCall","toolbarContainer","palette","toolbarBackground","main","bottom","right","paper","background","border","shadows","spacing","toolbarMobileContainer","infoButton","groupButton","activeButtons","activeButton","activeButtonIcon","ToolBar","root","wsStatus","info","action","paddingRight","networkStatusIcons","snackBarContent","EntitiesList","listOfEntities","List","ListItem","disablePadding","ListItemIcon","getIcon","Typography","getBgColor","component","gutterBottom","sx","pl","maxHeight","overflow","overflowY","bgcolor","ListItemText","primary","Collapse","in","timeout","unmountOnExit","_e","_i","Code","Description","Main","videoContainer","captions","setCaptions","credentials","setCredentials","setError","setHasAudio","setHasVideo","setUserId","userId","flexWrap","alignContent","Wrapper","banner","zIndex","marginTop","new__meeting","meetingInfo","minWidth","bullet","pos","marginBottom","centeredFlex","EndCall","recordings","setRecordings","fetchRecordings","Card","CardContent","CardActions","Date","createdAt","href","url","ProtectedRoute","Component","rest","computedMatch","params","props","to","header","alignSelf","VirtualView","App","preferencesValue","useMemo","ThemeProvider","createTheme","secondary","bodyBackground","black","callBackground","Provider","exact","path","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.bae5a9d1.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/logo.6ce24c58.svg\";","import { createContext } from 'react';\n\nexport const UserContext = createContext();\n","import axios from 'axios';\nlet API_URL = `${process.env.REACT_APP_API_URL_DEVELOPMENT}`;\nif (process.env.NODE_ENV === 'production') {\n  API_URL = `${process.env.REACT_APP_API_URL_PRODUCTION}`;\n}\nconst fetchRecordings = (sessionId) => {\n  return axios.get(`${API_URL}/archive/${sessionId}`);\n};\n\nconst startRecording = (sessionId) => {\n  console.log('Got session client side' + sessionId);\n  return axios.post(`${API_URL}/archive/start`, {\n    session_id: sessionId,\n  });\n};\n\nconst render = (roomName) => {\n  return axios.post(`${API_URL}/render`, { roomName: roomName });\n};\n\nconst stopRender = (id) => {\n  return axios.get(`${API_URL}/render/stop/${id}`);\n};\n\nconst stopRecording = (archiveId) => {\n  return axios.get(`${API_URL}/archive/stop/${archiveId}`);\n};\n\nexport { fetchRecordings, startRecording, stopRecording, render, stopRender };\n","import axios from 'axios';\n\nlet API_URL = process.env.REACT_APP_API_URL_DEVELOPMENT;\n\nconsole.log(process.env.NODE_ENV, API_URL);\n\n// let API_URL = `http://localhost:5000`;\nif (process.env.NODE_ENV === 'production') {\n  API_URL = `${process.env.REACT_APP_API_URL_PRODUCTION}`;\n}\n\nexport const getCredentials = async (roomName) => {\n  return axios.get(`${API_URL}/session/${roomName}`);\n};\nexport const getVirtualViewerCredentials = async (roomName) => {\n  return axios.get(`${API_URL}/session/${roomName}?role=virtual`);\n};\nexport const startTranslation = async (streamId, sessionId, specialty) => {\n  return axios.post(`${API_URL}/startStreaming`, {\n    streamId,\n    sessionId,\n    specialty\n  });\n};\n\nexport const stopStreamer = async (sessionId, connectionId) => {\n  return axios.get(`${API_URL}/stopStreamer/${sessionId}/${connectionId}`);\n};\n\nexport const getToken = async () => {\n  return axios.get(`${API_URL}/token`);\n};\n","import React, { useCallback, useRef, useState, useContext } from 'react';\nimport OT from '@opentok/client';\n\nimport { useParams } from 'react-router';\nimport { UserContext } from '../context/UserContext';\nimport { stopRecording, stopRender } from '../api/fetchRecording';\nimport useDevices from '../hooks/useDevices';\n\nimport { startTranslation, stopStreamer } from '../api/fetchCreds';\n\nexport function usePublisher() {\n  let { roomName } = useParams();\n  const { preferences } = useContext(UserContext);\n  const [isPublishing, setIsPublishing] = useState(false);\n  const [pubInitialised, setPubInitialised] = useState(false);\n  const publisherRef = useRef();\n  const [publisherError, setPublisherError] = useState(null);\n  const [connectionIdFromStream, setConnectionIdFromStreamer] = useState(null);\n  const [sessionId, setSessionId] = useState(null);\n  const { deviceInfo, getDevices } = useDevices();\n\n  const streamCreatedListener = React.useCallback(\n    ({ stream }) => {\n      console.log(stream);\n      preferences.streamId = stream.id;\n      const sessionId = stream.publisher.session.id;\n      console.log(sessionId);\n      setSessionId(sessionId);\n      // setConnectionIdFromStreamer('124');\n      console.log({roomName, specialty: localStorage.getItem('specialty')})\n      startTranslation(stream.id, sessionId, localStorage.getItem('specialty'))\n        .then((data) => {\n          console.log(data.data);\n          console.log('setting connectionId ' + data.data.connectionId);\n          setConnectionIdFromStreamer(data.data.connectionId);\n        })\n        .catch((e) => console.log(e));\n      setIsPublishing(true);\n    },\n    [preferences]\n  );\n\n  const streamDestroyedListener = useCallback(({ stream }) => {\n    console.log('destroyed publisher');\n\n    //the problem seems to be sessionid is undefined\n\n    // .then((data) => {})\n    // .catch((e) => console.log(e));\n    publisherRef.current = null;\n\n    setPubInitialised(false);\n    setIsPublishing(false);\n  }, []);\n\n  const initPublisher = useCallback(\n    (containerId, publisherOptions) => {\n      console.log('UsePublisher - initPublisher');\n      if (publisherRef.current) {\n        console.log('UsePublisher - Already initiated');\n        return;\n      }\n      if (!containerId) {\n        console.log('UsePublisher - Container not available');\n      }\n      const finalPublisherOptions = Object.assign({}, publisherOptions, {\n        width: '100%',\n        height: '100%',\n        name: preferences.name,\n        publishVideo: true,\n        publishAudio: true,\n        style: {\n          buttonDisplayMode: 'on',\n          nameDisplayMode: 'on',\n        },\n        insertMode: 'append',\n        // name: 'Javi',\n        showControls: true,\n        fitMode: 'contain',\n      });\n      console.log('usePublisher finalPublisherOptions', finalPublisherOptions);\n      publisherRef.current = OT.initPublisher(\n        containerId,\n        finalPublisherOptions,\n        (err) => {\n          if (err) {\n            console.log('[usePublisher]', err);\n            publisherRef.current = null;\n          }\n          console.log('Publisher Created');\n        }\n      );\n\n      setPubInitialised(true);\n\n      publisherRef.current.on('streamCreated', streamCreatedListener);\n      publisherRef.current.on('streamDestroyed', streamDestroyedListener);\n      // publisherRef.current.on('destroyed', () => {\n      //   console.log('publisherRef.current Destroyed');\n      // });\n    },\n    [preferences.name, streamCreatedListener, streamDestroyedListener]\n  );\n\n  const destroyPublisher = useCallback(() => {\n    if (!publisherRef.current) {\n      return;\n    }\n    if (sessionId && connectionIdFromStream) {\n      publisherRef.current.destroy();\n    }\n    if (preferences.renderId && preferences.archiveId) {\n      stopRender(preferences.renderId).then((data) => console.log(data));\n      stopRecording(preferences.archiveId).then((data) => console.log(data));\n    }\n    publisherRef.current.on('destroyed', () => {\n      console.log('publisherRef.current Destroyed');\n    });\n  }, [\n    connectionIdFromStream,\n    preferences.archiveId,\n    preferences.renderId,\n    sessionId,\n  ]);\n\n  const publish = useCallback(\n    ({ session, containerId, publisherOptions }) => {\n      if (!publisherRef.current) {\n        initPublisher(containerId, publisherOptions);\n      }\n      if (session && publisherRef.current && !isPublishing) {\n        return new Promise((resolve, reject) => {\n          session.publish(publisherRef.current, (err) => {\n            if (err) {\n              console.log('Publisher Error', err);\n              setIsPublishing(false);\n              publisherRef.current = null;\n              setPublisherError(true);\n              reject(err);\n            }\n            console.log('Published');\n            resolve(publisherRef.current);\n          });\n        });\n      } else if (publisherRef.current) {\n        // nothing to do\n      }\n    },\n    [initPublisher, isPublishing]\n  );\n\n  const unpublish = useCallback(\n    ({ session }) => {\n      if (publisherRef.current && isPublishing) {\n        session.unpublish(publisherRef.current);\n        setIsPublishing(false);\n        publisherRef.current = null;\n      }\n    },\n    [isPublishing, publisherRef]\n  );\n\n  return {\n    publisher: publisherRef.current,\n    initPublisher,\n    destroyPublisher,\n    publish,\n    pubInitialised,\n    unpublish,\n    isPublishing,\n    publisherError,\n    deviceInfo,\n  };\n}\n","import { useState, useEffect, useCallback } from 'react';\nimport OT from '@opentok/client';\n\nexport default function useDevices() {\n    const [deviceInfo, setDeviceInfo] = useState({\n        audioInputDevices: [],\n        videoInputDevices: [],\n        audioOutputDevices: []\n    });\n\n    const getDevices = useCallback(async () => {\n        if (!navigator.mediaDevices || !navigator.mediaDevices.enumerateDevices) {\n            console.warn('enumerateDevices() not supported.');\n            return;\n        }\n        return new Promise((resolve, reject) => {\n            OT.getDevices(async (err, devices) => {\n                if (err) {\n                    reject(err);\n                }\n                let audioOutputDevices = await OT.getAudioOutputDevices();\n                audioOutputDevices = audioOutputDevices.map((audiooutput) =>\n                    audiooutput.deviceId === 'default'\n                        ? { ...audiooutput, label: 'System Default' }\n                        : audiooutput\n                );\n                const audioInputDevices = devices.filter(\n                    (d) => d.kind.toLowerCase() === 'audioinput'\n                );\n                const videoInputDevices = devices.filter(\n                    (d) => d.kind.toLowerCase() === 'videoinput'\n                );\n                setDeviceInfo({\n                    audioInputDevices,\n                    videoInputDevices,\n                    audioOutputDevices\n                });\n            });\n        });\n    }, []);\n\n    useEffect(() => {\n        navigator.mediaDevices.addEventListener('devicechange', getDevices);\n        getDevices();\n\n        return () => {\n            navigator.mediaDevices.removeEventListener('devicechange', getDevices);\n        };\n    }, [getDevices]);\n\n    return { deviceInfo, getDevices };\n}","import React from \"react\";\n\nimport Mic from \"@material-ui/icons/Mic\";\nimport Switch from \"@material-ui/core/Switch\";\n\nexport const AudioSettings = React.memo(\n  ({ hasAudio, onAudioChange, className }) => {\n    return (\n      <div className={className}>\n        <Mic />\n        <div>Microphone</div>\n        <Switch\n          checked={hasAudio}\n          onChange={onAudioChange}\n          name=\"AudioToggle\"\n        />\n      </div>\n    );\n  }\n);\n","import React from \"react\";\n\nimport Videocam from \"@material-ui/icons/Videocam\";\nimport Switch from \"@material-ui/core/Switch\";\n\nexport const VideoSettings = React.memo(\n  ({ hasVideo, onVideoChange, className }) => {\n    // const [enabled, setEnabled] = useState(hasAudio);\n    console.log(\"Video Setting\", hasVideo);\n    return (\n      <div className={className}>\n        <Videocam />\n        <div>Video</div>\n        <Switch\n          checked={hasVideo}\n          onChange={onVideoChange}\n          name=\"VideoToggle\"\n        />\n      </div>\n    );\n  }\n);\n","import { makeStyles } from '@material-ui/core/styles';\nimport { blueGrey, green, red } from '@material-ui/core/colors';\nexport default makeStyles((theme) => ({\n  waitingRoomContainer: {\n    position: 'absolute',\n    left: '50%',\n    top: '50%',\n    display: 'flex',\n    flexDirection: 'column',\n    transform: 'translate(-50%, -50%)',\n    backgroundColor: blueGrey[100],\n    padding: '10px 20px',\n    borderRadius: 5,\n    width: '360px'\n  },\n  waitingRoomVideoContainer: {\n    width: '360px',\n    height: '264px'\n  },\n  deviceContainer: {\n    display: 'flex',\n    flexDirection: 'column',\n    margin: '5px 0'\n  },\n  deviceSettings: {\n    display: 'flex',\n    justifyContent: 'space-around',\n    alignItems: 'center'\n  },\n  selectWidth: {\n    width: '200px'\n  },\n  networkTestContainer: {\n    display: 'flex',\n    flexDirection: 'column',\n    margin: '10px 5px'\n  },\n  flex: {\n    display: 'flex'\n  },\n  green: {\n    color: green[600]\n  },\n  red: {\n    color: red[600]\n  },\n  containerCenter: {\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    margin: '3px',\n    flexDirection: 'column'\n  }\n}));","/**\n * For both audio and video\n * \n * @param {*} inputDevices \n * @param {*} currentSource \n * @returns String toReturn\n */\n\n// const getAudioSourceDeviceId = (audioInputDevices, currentAudioSource) => {\n//   let toReturn = '';\n//   console.log('getAudioSourceDeviceId', audioInputDevices, currentAudioSource);\n//   if (!audioInputDevices || !currentAudioSource) {\n//     return toReturn;\n//   }\n//   for (let i = 0; i < audioInputDevices.length; i += 1) {\n//     if (audioInputDevices[i].label === currentAudioSource.label) {\n//       toReturn = audioInputDevices[i].deviceId;\n//       break;\n//     }\n//   }\n//   return toReturn;\n// };\n// export { getAudioSourceDeviceId };\n\nconst getSourceDeviceId = (inputDevices, currentSource) => {\n  let toReturn = '';\n  console.log('getSourceDeviceId', inputDevices, currentSource);\n  if (!inputDevices || !currentSource) {\n    return toReturn;\n  }\n  for (let i = 0; i < inputDevices.length; i += 1) {\n    if (inputDevices[i].label === currentSource.label) {\n      toReturn = inputDevices[i].deviceId;\n      break;\n    }\n  }\n  return toReturn;\n};\n\nexport { getSourceDeviceId };\n","import React, { useContext, useEffect, useRef, useState } from 'react';\nimport OT from '@opentok/client';\nimport { useHistory } from 'react-router-dom';\nimport {\n  Button,\n  FormControl,\n  InputLabel,\n  MenuItem,\n  Select,\n  TextField\n} from '@material-ui/core';\nimport { usePublisher } from '../../hooks/usePublisher';\nimport { AudioSettings } from '../AudioSetting';\nimport { VideoSettings } from '../VideoSetting';\nimport { UserContext } from '../../context/UserContext';\nimport useStyles from './styles';\nimport { getSourceDeviceId } from '../../utils';\n\nexport default function WaitingRoom() {\n  const classes = useStyles();\n  const { preferences, setPreferences } = useContext(UserContext);\n  const { push } = useHistory();\n  const defaultLocalAudio = true;\n  const defaultLocalVideo = true;\n  const [localAudio, setLocalAudio] = useState(defaultLocalAudio);\n  const [localVideo, setLocalVideo] = useState(defaultLocalVideo);\n  const [localVideoSource, setLocalVideoSource] = useState(undefined);\n  const [localAudioSource, setLocalAudioSource] = useState(undefined);\n  const [localAudioOutput, setLocalAudioOutput] = useState(undefined);\n  let [audioDevice, setAudioDevice] = useState('');\n  let [videoDevice, setVideoDevice] = useState('');\n  let [audioOutputDevice, setAudioOutputDevice] = useState('');\n  const [specialty, setSpecialty] = useState('PRIMARYCARE');\n  const [roomName, setRoomName] = useState('');\n  const [userName, setUserName] = useState('');\n  const [isRoomNameInvalid, setIsRoomNameInvalid] = useState(false);\n  const [isUserNameInvalid, setIsUserNameInvalid] = useState(false);\n  const waitingRoomVideoContainer = useRef();\n\n  const {\n    publisher,\n    initPublisher,\n    destroyPublisher,\n    deviceInfo,\n    pubInitialised\n  } = usePublisher();\n\n  const handleAudioChange = React.useCallback((e) => {\n    setLocalAudio(e.target.checked);\n  }, []);\n\n  const handleVideoChange = React.useCallback((e) => {\n    setLocalVideo(e.target.checked);\n  }, []);\n\n  const handleVideoSource = React.useCallback(\n    (e) => {\n      const videoDeviceId = e.target.value;\n      setVideoDevice(e.target.value);\n      publisher.setVideoSource(videoDeviceId);\n      setLocalVideoSource(videoDeviceId);\n    },\n    [publisher, setVideoDevice, setLocalVideoSource]\n  );\n\n  const handleAudioSource = React.useCallback(\n    (e) => {\n      const audioDeviceId = e.target.value;\n      setAudioDevice(audioDeviceId);\n      publisher.setAudioSource(audioDeviceId);\n      setLocalAudioSource(audioDeviceId);\n    },\n    [publisher, setAudioDevice, setLocalAudioSource]\n  );\n\n  const handleAudioOutput = React.useCallback(\n    (e) => {\n      const audioOutputId = e.target.value;\n      setAudioOutputDevice(audioOutputId);\n      OT.setAudioOutputDevice(audioOutputId);\n      setLocalAudioOutput(audioOutputId);\n    },\n    [setLocalAudioOutput, setAudioOutputDevice]\n  );\n\n  const validateForm = () => {\n    console.log(\"validateForm\", userName);\n    console.log(\"validateForm\", roomName);\n    if (userName === '') {\n      setIsUserNameInvalid(true);\n      return false;\n    } else if (roomName === '') {\n      setIsRoomNameInvalid(true);\n      return false;\n    }\n    return true;\n  };\n\n  const handleJoinClick = () => {\n    if (validateForm()) {\n      localStorage.setItem('username', userName);\n      localStorage.setItem('specialty', specialty);\n      push(`room/${roomName}`);\n    }\n  };\n\n  const onChangeRoomName = (e) => {\n    const roomName = e.target.value;\n    if (roomName === '' || roomName.trim() === '') {\n      // Space detected\n      setRoomName('');\n      return;\n    }\n    setIsRoomNameInvalid(false);\n    setRoomName(roomName);\n  };\n\n  const onChangeParticipantName = (e) => {\n    const userName = e.target.value;\n    if (userName === '' || userName.trim() === '') {\n      // Space detected\n      setUserName('');\n      return;\n    }\n    setIsUserNameInvalid(false);\n    setUserName(userName);\n  };\n\n  const onKeyDown = (e) => {\n    if (e.keyCode === 13) {\n      handleJoinClick();\n    }\n  };\n\n  useEffect(() => {\n    const publisherOptions = {\n      publishAudio: defaultLocalAudio,\n      publishVideo: defaultLocalVideo\n    };\n    if (waitingRoomVideoContainer.current) {\n      initPublisher(waitingRoomVideoContainer.current.id, publisherOptions);\n    }\n  }, [initPublisher, defaultLocalAudio, defaultLocalVideo]);\n\n  useEffect(() => {\n    if (publisher) {\n      publisher.publishAudio(localAudio);\n    }\n  }, [localAudio, publisher]);\n\n  useEffect(() => {\n    if (publisher) {\n      publisher.publishVideo(localVideo);\n    }\n  }, [localVideo, publisher]);\n\n  useEffect(() => {\n    if (publisher && pubInitialised && deviceInfo) {\n      publisher.on('accessAllowed', (e) => {\n\n        const currentAudioDevice = publisher.getAudioSource();\n        setAudioDevice(\n          getSourceDeviceId(deviceInfo.audioInputDevices, currentAudioDevice)\n        );\n\n        const currentVideoDevice = publisher.getVideoSource();\n        setVideoDevice(\n          getSourceDeviceId(deviceInfo.videoInputDevices, currentVideoDevice?.track)\n        );\n  \n        OT.getActiveAudioOutputDevice().then((currentAudioOutputDevice) => {\n          setAudioOutputDevice(currentAudioOutputDevice.deviceId);\n        });\n\n      })\n    }\n  }, [\n    deviceInfo,\n    publisher,\n    setAudioDevice,\n    setVideoDevice,\n    setAudioOutputDevice,\n    pubInitialised\n  ]);\n\n  useEffect(() => {\n    return () => {\n      destroyPublisher();\n    };\n  }, [destroyPublisher]);\n\n  useEffect(() => {\n    setPreferences({\n      defaultSettings: {\n        publishAudio: localAudio,\n        publishVideo: localVideo,\n        audioSource: localAudioSource,\n        videoSource: localVideoSource,\n        audioOutput: localAudioOutput\n      },\n    });\n  }, [\n    localAudio,\n    localVideo,\n    setPreferences,\n    localAudioSource,\n    localVideoSource,\n    localAudioOutput\n  ]);\n\n  return (\n    <div className={classes.waitingRoomContainer}>\n      <div\n        className={classes.containerCenter}\n      >\n        <div className={classes.waitingRoomVideoPreview} >\n          <form className={classes.form} noValidate>\n            <FormControl fullWidth > \n              <InputLabel id=\"specialty-select-label\">\n              Medical Specialty\n              </InputLabel>\n              <Select\n                size=\"small\"\n                labelId=\"specialty-select-label\"\n                id=\"specialty-select\"\n                name=\"specialty\"\n                value={specialty}\n                onChange={e => setSpecialty(e.target.value)}\n              >\n                {['PRIMARYCARE', 'CARDIOLOGY', 'NEUROLOGY', 'ONCOLOGY', 'RADIOLOGY', 'UROLOGY']\n                  .map((value, key) => (\n                  <MenuItem key={key} value={value}>{value}</MenuItem>\n                ))}\n              </Select>\n            </FormControl>\n            <TextField\n              size=\"small\"\n              variant=\"outlined\"\n              margin=\"dense\"\n              required\n              fullWidth\n              id=\"room-name\"\n              label=\"Room Name\"\n              name=\"roomName\"\n              autoComplete=\"Room Name\"\n              error={isRoomNameInvalid}\n              autoFocus\n              // helperText={roomName === '' ? 'Empty Field' : ' '}\n              value={roomName}\n              onChange={onChangeRoomName}\n              onKeyDown={onKeyDown}\n            />\n            <TextField\n              size=\"small\"\n              variant=\"outlined\"\n              margin=\"none\"\n              fullWidth\n              id=\"publisher-name\"\n              label=\"Name\"\n              name=\"name\"\n              error={isUserNameInvalid}\n              required\n              autoComplete=\"Name\"\n              // helperText={userName === '' ? 'Empty Field' : ' '}\n              value={userName}\n              onChange={onChangeParticipantName}\n              onKeyDown={onKeyDown}\n            />\n          </form>\n          <div className={classes.deviceContainer}>\n            <>\n              <FormControl margin=\"dense\">\n                <InputLabel id=\"demo-simple-select-label\">\n                  Select Audio Source\n                </InputLabel>\n                <Select\n                  labelId=\"demo-simple-select-label\"\n                  id=\"demo-simple-select\"\n                  value={audioDevice}\n                  onChange={handleAudioSource}\n                  autoWidth={true}\n                >\n                  {deviceInfo.audioInputDevices.map((device) => (\n                    <MenuItem key={device.deviceId} value={device.deviceId}>\n                      {device.label}\n                    </MenuItem>\n                  ))}\n                </Select>\n              </FormControl>\n\n              <FormControl margin=\"dense\">\n                <InputLabel id=\"video\">Select Audio Output</InputLabel>\n                {deviceInfo.audioOutputDevices && (\n                  <Select\n                    labelId=\"video\"\n                    id=\"demo-simple-select\"\n                    value={audioOutputDevice}\n                    onChange={handleAudioOutput}\n                    autoWidth={true}\n                  >\n                    {deviceInfo.audioOutputDevices.map((device) => (\n                      <MenuItem key={device.deviceId} value={device.deviceId}>\n                        {device.label}\n                      </MenuItem>\n                    ))}\n                  </Select>\n                )}\n              </FormControl>\n\n              <FormControl margin=\"dense\">\n                <InputLabel id=\"video\">Select Video Source</InputLabel>\n                {deviceInfo.videoInputDevices && (\n                  <Select\n                    labelId=\"video\"\n                    id=\"demo-simple-select\"\n                    value={videoDevice}\n                    onChange={handleVideoSource}\n                    autoWidth={true}\n                  >\n                    {deviceInfo.videoInputDevices.map((device) => (\n                      <MenuItem key={device.deviceId} value={device.deviceId}>\n                        {device.label}\n                      </MenuItem>\n                    ))}\n                  </Select>\n                )}\n              </FormControl>\n            </>\n          </div>\n          <div className={classes.deviceContainer}>\n            <AudioSettings\n              className={classes.deviceSettings}\n              hasAudio={localAudio}\n              onAudioChange={handleAudioChange}\n            />\n            <VideoSettings\n              className={classes.deviceSettings}\n              hasVideo={localVideo}\n              onVideoChange={handleVideoChange}\n            />\n          </div>\n          <div\n            id=\"waiting-room-video-container\"\n            className={classes.waitingRoomVideoContainer} \n            ref={waitingRoomVideoContainer}\n          >\n          </div>\n        </div>\n      </div>\n      <div\n        className={classes.containerCenter}\n      >\n        <Button variant=\"contained\" color=\"secondary\" onClick={handleJoinClick}>\n          Join Call\n        </Button>\n      </div>\n    </div>\n  );\n}","import React, { useState, useRef, useCallback } from 'react';\n\nimport _ from 'lodash';\nimport OT from '@opentok/client';\n// const OT = window.OT;\n\nexport function useSession({ container }) {\n  const [connected, setConnected] = useState(false);\n  const [streams, setStreams] = useState([]);\n  const sessionRef = useRef(null);\n  const [status, setNetworkStatus] = useState(null);\n\n  const addStream = ({ stream }) => {\n    setStreams((prev) => [...prev, stream]);\n  };\n\n  const removeStream = ({ stream }) => {\n    setStreams((prev) =>\n      prev.filter((prevStream) => prevStream.id !== stream.id)\n    );\n  };\n\n  const isExperienceComposer = () => {\n    const queryString = window.location.pathname;\n    return queryString.split('/')[2] === 'virtualviewer';\n  };\n\n  const isRecorder = () => {\n    const queryString = window.location.pathname;\n    return queryString.split('/')[2] === 'recorder';\n  };\n\n  const shouldSubscribeToVideo = (name) => {\n    // if (name.split('_')[1] === 'EC') return false;\n    return name !== 'EC';\n    // if (name === 'EC') return false;\n    // else return true;\n  };\n\n  const shouldSubscribeToAudio = React.useCallback((name) => {\n    if (isExperienceComposer()) return false;\n    if (isRecorder()) return true;\n    else return true;\n  }, []);\n\n  const subscribe = React.useCallback(\n    (stream, options = {}) => {\n      console.log(stream);\n      if (sessionRef.current && container.current) {\n        const finalOptions = Object.assign({}, options, {\n          insertMode: 'append',\n          width: '100%',\n          height: '100%',\n          fitMode: 'contain',\n          style: {\n            buttonDisplayMode: 'on',\n            nameDisplayMode: 'on',\n          },\n          showControls: true,\n          subscribeToVideo: shouldSubscribeToVideo(stream.name),\n          // subscribeToAudio: shouldSubscribeToVideo(stream.name),\n          // subscribeToAudio: !isExperienceComposer(),\n          subscribeToAudio: shouldSubscribeToAudio(),\n          //   isExperienceComposer() && stream.name === 'EC' ? false : true,\n        });\n        const subscriber = sessionRef.current.subscribe(\n          stream,\n          shouldSubscribeToVideo(stream.name) ? container.current.id : null,\n          finalOptions\n        );\n      }\n    },\n    [container, shouldSubscribeToAudio]\n  );\n\n  const onStreamCreated = useCallback(\n    (event) => {\n      console.log('stream created event ' + event.stream.name);\n      console.log(\n        ' subscribe to video ' + shouldSubscribeToVideo(event.stream.name)\n      );\n      console.log('is experience composer ' + isExperienceComposer());\n\n      subscribe(event.stream);\n      addStream({ stream: event.stream });\n    },\n    [subscribe]\n  );\n\n  const onStreamDestroyed = useCallback((event) => {\n    removeStream({ stream: event.stream });\n  }, []);\n\n  const onSessionDisconnected = useCallback((event) => {\n    setNetworkStatus('disconnected');\n  }, []);\n  const onSessionReconnecting = useCallback((event) => {\n    setNetworkStatus('reconnecting');\n  }, []);\n\n  const onConnectionDestroyed = useCallback((event) => {\n    console.log(event);\n  }, []);\n\n  const createSession = useCallback(\n    ({ apiKey, sessionId, token }) => {\n      if (!apiKey) {\n        throw new Error('Missing apiKey');\n      }\n\n      if (!sessionId) {\n        throw new Error('Missing sessionId');\n      }\n\n      if (!token) {\n        throw new Error('Missing token');\n      }\n\n      sessionRef.current = OT.initSession(apiKey, sessionId, {});\n      const eventHandlers = {\n        streamCreated: onStreamCreated,\n        streamDestroyed: onStreamDestroyed,\n        sessionReconnecting: onSessionReconnecting,\n        sessionDisconnected: onSessionDisconnected,\n        connectionDestoyed: onConnectionDestroyed,\n      };\n      sessionRef.current.on(eventHandlers);\n      return new Promise((resolve, reject) => {\n        sessionRef.current.connect(token, (err) => {\n          if (!sessionRef.current) {\n            // Either this session has been disconnected or OTSession\n            // has been unmounted so don't invoke any callbacks\n            return;\n          }\n          if (err) {\n            reject(err);\n          } else if (!err) {\n            console.log('Session Connected!');\n            setConnected(true);\n            resolve(sessionRef.current);\n          }\n        });\n      });\n    },\n    [\n      onConnectionDestroyed,\n      onSessionDisconnected,\n      onSessionReconnecting,\n      onStreamCreated,\n      onStreamDestroyed,\n    ]\n  );\n\n  const destroySession = React.useCallback(() => {\n    if (sessionRef.current) {\n      sessionRef.current.on('disconnected', () => {\n        sessionRef.current = null;\n      });\n      sessionRef.current.disconnect();\n    }\n  }, []);\n\n  return {\n    session: sessionRef,\n    connected,\n    createSession,\n    destroySession,\n    streams,\n    status,\n  };\n}\n","import { makeStyles } from '@material-ui/core/styles';\n// export default makeStyles((theme)=>{\nexport default makeStyles({\n  selected: {\n    color: '#b779ff'\n  }\n});\n","// import MicIcon from '@material-ui/icons/Mic';\nimport MicIcon from '@mui/icons-material/Mic';\nimport MicOffIcon from '@mui/icons-material/MicOff';\nimport { IconButton } from '@material-ui/core';\nimport Tooltip from '@material-ui/core/Tooltip';\n\nimport ButtonGroup from '@material-ui/core/ButtonGroup';\nimport ClickAwayListener from '@material-ui/core/ClickAwayListener';\nimport Grow from '@material-ui/core/Grow';\nimport Paper from '@material-ui/core/Paper';\nimport Popper from '@material-ui/core/Popper';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport MenuList from '@material-ui/core/MenuList';\nimport React from 'react';\nimport styles from './styles.js';\n\nexport default function MuteAudioButton({\n  toggleAudio,\n  hasAudio,\n  classes,\n  handleAudioChange,\n}) {\n  const title = hasAudio ? 'Disable Microphone' : 'Enable Microphone';\n  const localClasses = styles();\n  // console.log(classes);\n\n  // const { deviceInfo } = useDevices();\n  // const [devicesAvailable, setDevicesAvailable] = React.useState(null);\n  // const [options, setOptions] = React.useState([]);\n  // const [open, setOpen] = React.useState(false);\n  // const anchorRef = React.useRef(null);\n  // const [selectedIndex, setSelectedIndex] = React.useState(0);\n  // const [audioDeviceId, setAudioDeviceId] = React.useState('');\n\n  // React.useEffect(() => {\n  //   setDevicesAvailable(deviceInfo.audioInputDevices);\n\n  //   if (cameraPublishing && devicesAvailable) {\n  //     getAudioSource().then((id) => setAudioDeviceId(id));\n\n  //     const indexOfSelectedElement = devicesAvailable.indexOf(\n  //       devicesAvailable.find((e) => e.deviceId === audioDeviceId)\n  //     );\n\n  //     setSelectedIndex(indexOfSelectedElement);\n  //   }\n  // }, [\n  //   cameraPublishing,\n  //   getAudioSource,\n  //   deviceInfo,\n  //   audioDeviceId,\n  //   devicesAvailable\n  // ]);\n\n  // React.useEffect(() => {\n  //   if (devicesAvailable) {\n  //     const audioDevicesAvailable = devicesAvailable.map((e) => {\n  //       return e.label;\n  //     });\n  //     setOptions(audioDevicesAvailable);\n  //   }\n  // }, [devicesAvailable]);\n\n  // const handleChangeAudioSource = (event, index) => {\n  //   setSelectedIndex(index);\n  //   console.log(index);\n  //   setOpen(false);\n  //   const audioDeviceId = devicesAvailable.find(\n  //     (device) => device.label === event.target.textContent\n  //   ).deviceId;\n  //   changeAudioSource(audioDeviceId);\n  // };\n\n  // const handleToggle = (e) => {\n  //   setOpen((prevOpen) => !prevOpen);\n  // };\n\n  // const handleClose = (event) => {\n  //   if (anchorRef.current && anchorRef.current.contains(event.target)) {\n  //     return;\n  //   }\n  //   setOpen(false);\n  // };\n\n  return (\n    <>\n      <Tooltip title={title} aria-label=\"add\">\n        <IconButton\n          edge=\"start\"\n          color=\"inherit\"\n          aria-label=\"mic\"\n          onClick={handleAudioChange}\n          className={`${classes.toolbarButtons} ${\n            !hasAudio ? classes.disabledButton : ''\n          }\n          `}\n        >\n          {!hasAudio ? (\n            <MicOffIcon fontSize=\"large\" />\n          ) : (\n            <MicIcon fontSize=\"large\" />\n          )}\n        </IconButton>\n      </Tooltip>\n    </>\n  );\n}\n","import { makeStyles } from '@material-ui/core/styles';\nexport default makeStyles({\n  selected: {\n    color: '#b779ff',\n    backgroundColor: 'black'\n  }\n});\n","import VideoCam from '@mui/icons-material/Videocam';\nimport VideocamOff from '@mui/icons-material/VideocamOff';\nimport { IconButton } from '@material-ui/core';\nimport Tooltip from '@material-ui/core/Tooltip';\n\nimport ButtonGroup from '@material-ui/core/ButtonGroup';\n// import ArrowDropDownIcon from '@material-ui/icons/ArrowDropDown';\nimport ClickAwayListener from '@material-ui/core/ClickAwayListener';\nimport Grow from '@material-ui/core/Grow';\nimport Paper from '@material-ui/core/Paper';\nimport Popper from '@material-ui/core/Popper';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport MenuList from '@material-ui/core/MenuList';\nimport React from 'react';\nimport styles from './styles.js';\n\nexport default function MuteVideoButton({\n  classes,\n  hasVideo,\n  handleVideoChange,\n}) {\n  const title = hasVideo ? 'Disable Camera' : 'Enable Camera';\n  // console.log('[MuteVideoButton] - hasVideo', hasVideo);\n\n  const [devicesAvailable, setDevicesAvailable] = React.useState(null);\n  const [options, setOptions] = React.useState([]);\n  const [open, setOpen] = React.useState(false);\n  const anchorRef = React.useRef(null);\n  const [selectedIndex, setSelectedIndex] = React.useState(0);\n  const localClasses = styles();\n\n  // React.useEffect(() => {\n  //   setDevicesAvailable(deviceInfo.videoInputDevices);\n\n  //   if (cameraPublishing) {\n  //     const currentDeviceId = getVideoSource()?.deviceId;\n\n  //     const IndexOfSelectedElement = devicesAvailable.indexOf(\n  //       devicesAvailable.find((e) => e.deviceId === currentDeviceId)\n  //     );\n  //     setSelectedIndex(IndexOfSelectedElement);\n  //   }\n  // }, [cameraPublishing, getVideoSource, deviceInfo]);\n\n  // React.useEffect(() => {\n  //   if (devicesAvailable) {\n  //     const videoDevicesAvailable = devicesAvailable.map((e) => {\n  //       return e.label;\n  //     });\n  //     setOptions(videoDevicesAvailable);\n  //   }\n  // }, [devicesAvailable]);\n\n  // const handleChangeVideoSource = (event, index) => {\n  //   setSelectedIndex(index);\n  //   setOpen(false);\n  //   const videoDeviceId = devicesAvailable.find(\n  //     (device) => device.label === event.target.textContent\n  //   ).deviceId;\n  //   changeVideoSource(videoDeviceId);\n  // };\n\n  // const handleToggle = (e) => {\n  //   setOpen((prevOpen) => !prevOpen);\n  // };\n\n  // const handleClose = (event) => {\n  //   if (anchorRef.current && anchorRef.current.contains(event.target)) {\n  //     return;\n  //   }\n  //   setOpen(false);\n  // };\n\n  return (\n    <>\n      <Tooltip title={title} aria-label=\"add\">\n        <IconButton\n          onClick={handleVideoChange}\n          edge=\"start\"\n          aria-label=\"videoCamera\"\n          size=\"small\"\n          className={`${classes.arrowButton} ${\n            !hasVideo ? classes.disabledButton : ''\n          }`}\n        >\n          {!hasVideo ? (\n            <VideocamOff fontSize=\"large\" />\n          ) : (\n            <VideoCam fontSize=\"large\" />\n          )}\n        </IconButton>\n      </Tooltip>\n    </>\n  );\n}\n","import { useState, useCallback, useEffect, useContext } from 'react';\n// import { Message } from '../entities/ChatMessage';\n// import { UserContext } from '../context/UserContext';\nimport { v4 as uuid } from 'uuid';\n\nexport function useSignalling({ session }) {\n  const [messages, setMessages] = useState(null);\n  const [entities, setEntities] = useState(null);\n  const [archiveId, setArchiveId] = useState(null);\n  const [renderedSesion, setRenderedSession] = useState(null);\n  const [medication, setMedicationEntities] = useState([]);\n  const [medicalConditions, setMedicalConditionsEntities] = useState([]);\n  const [anatomyEntities, setAnatomyEntities] = useState([]);\n  const [piiEntities, setPiiEntities] = useState([]);\n  //   const { user } = useContext(UserContext);\n\n  const signal = useCallback(\n    async ({ type, data }) => {\n      return new Promise((resolve, reject) => {\n        const payload = JSON.parse(JSON.stringify({ type, data }));\n        if (session) {\n          session.signal(payload, (err) => {\n            if (err) reject(err);\n            else resolve();\n          });\n        }\n      });\n    },\n    [session]\n  );\n\n  const archiveListener = useCallback(({ data }) => {\n    console.log(data);\n    const archiveId = data.split(':')[0];\n    const sessionRendered = data.split(':')[1];\n    setArchiveId(archiveId);\n    setRenderedSession(sessionRendered);\n  }, []);\n\n  const sendMessage = useCallback(\n    (message) => {\n      return signal({ type: 'message', data: message });\n    },\n    [signal]\n  );\n\n  // useEffect(() => {\n  //   if (medicalConditions) console.log(medicalConditions);\n  //   if (medication) console.log(medication);\n  // }, [medicalContitions, medication]);\n\n  const medicationListener = useCallback(({ data, from }) => {\n    const dataJson = JSON.parse(data);\n    // const medString = `${dataJson[0].Description} | ${dataJson[0].Code}`;\n    // setMedicationEntities((prev) => [...prev, medString]);\n    //console.log(dataJson)\n    if (dataJson.length) {\n      dataJson.forEach((entity) => {\n        setMedicationEntities((prev) => [...prev, {\n          Text: `${entity.Text} | ${entity.Score}`, \n          concepts: entity.RxNormConcepts? entity.RxNormConcepts : []\n        }]);\n      })\n    }\n  }, []);\n\n  const medConditionListener = useCallback(({ data, from }) => {\n    const dataJson = JSON.parse(data);\n    // const medString = `${dataJson[0].Description} | ${dataJson[0].Code}`;\n    // setMedicalConditionsEntities((prev) => [...prev, medString]);\n    if (dataJson.length) {\n      dataJson.forEach((entity) => {\n        setMedicalConditionsEntities((prev) => [...prev, {\n          Text: `${entity.Text} | ${entity.Score}`, \n          concepts: entity.ICD10CMConcepts? entity.ICD10CMConcepts : []\n        }]);\n      })\n    }\n  }, []);\n\n  const entitiesListener = useCallback(({ data, from }) => {\n    const dataJson = JSON.parse(data);\n    if (dataJson.length) {\n      dataJson.forEach((entity) => {\n        if (entity?.Category === 'ANATOMY')\n          setAnatomyEntities((prev) => [...prev, entity]);\n\n        if (entity?.Category === 'PROTECTED_HEALTH_INFORMATION')\n          setPiiEntities((prev) => [...prev, entity]);\n      });\n    }\n  }, []);\n\n  const messageListener = useCallback(({ data, from }) => {\n    console.log('received message');\n    console.log(data);\n    setMessages(data);\n  }, []);\n\n  useEffect(() => {\n    if (session) {\n      session.on('signal:captions', messageListener);\n      session.on('signal:medicalEntities', entitiesListener);\n      session.on('signal:archiveStarted', archiveListener);\n      session.on('signal:medication', medicationListener);\n      session.on('signal:medCondition', medConditionListener);\n    }\n    return function cleanup() {\n      if (session) {\n        session.off('signal:captions', messageListener);\n        session.off('signal:archiveStarted', archiveListener);\n        session.off('signal:medicalEntities', entitiesListener);\n        session.off('signal:medication', medicationListener);\n        session.off('signal:medCondition', medicationListener);\n      }\n    };\n  }, [\n    session,\n    messageListener,\n    archiveListener,\n    entitiesListener,\n    medicationListener,\n    medConditionListener,\n  ]);\n\n  return {\n    sendMessage,\n    messages,\n    archiveId,\n    renderedSesion,\n    medicalConditions,\n    medication,\n    piiEntities,\n    anatomyEntities,\n  };\n}\n","import { makeStyles } from '@material-ui/core/styles';\nexport default makeStyles((theme) => ({\n  activeRecordingIcon: {\n    boxShadow: '0 0 0 0 rgba(213, 15, 45, 1)',\n    animation: 'pulse-red 2s infinite',\n    borderRadius: '100%',\n  },\n}));\n","import { useState, useContext } from 'react';\nimport {\n  startRecording,\n  stopRecording,\n  render,\n  stopRender,\n} from '../../api/fetchRecording';\n\nimport { fixChrome687574, stopRenderAndRecording } from '../../utils';\n\nimport { useSignalling } from '../../hooks/useSignalling';\n\nimport { UserContext } from '../../context/UserContext';\n\nimport FiberManualRecordIcon from '@mui/icons-material/FiberManualRecord';\nimport { IconButton } from '@material-ui/core';\nimport styles from './styles';\nimport Tooltip from '@mui/material/Tooltip';\nimport { useParams } from 'react-router';\nimport { useEffect } from 'react';\n\nexport default function RecordingButton({ classes, session }) {\n  const { preferences, setPreferences } = useContext(UserContext);\n  let { roomName } = useParams();\n  const { archiveId } = useSignalling({ session });\n  const [isRecording, setRecording] = useState(false);\n  const [renderId, setRenderId] = useState(null);\n  const localClasses = styles();\n\n  const startRender = async (roomName) => {\n    if (isRecording) return;\n    try {\n      const renderData = await render(roomName);\n      if ((renderData.status = 200 && renderData.data)) {\n        const { id, sessionId } = renderData.data;\n        // console.log(renderData.data);\n        // setRenderId('12334');\n        preferences.renderId = id;\n        setRenderId(id);\n        setRecording(true);\n      } else return;\n    } catch (e) {\n      console.log(e);\n    }\n  };\n\n  useEffect(() => {\n    console.log('run preferences hook');\n    if (\n      renderId !== preferences.renderId ||\n      archiveId !== preferences.archiveId\n    ) {\n      if (renderId) {\n        setPreferences({\n          ...preferences,\n          renderId: renderId,\n          archiveId: archiveId,\n        });\n      }\n    }\n  }, [renderId, setPreferences, archiveId, preferences]);\n\n  useEffect(() => {\n    if (preferences.recording !== isRecording) {\n      setPreferences({\n        ...preferences,\n        recording: isRecording,\n      });\n    }\n    // } else {\n    //   setPreferences({\n    //     ...preferences,\n    //     recording: false,\n    //   });\n    // }\n  }, [isRecording, preferences, setPreferences]);\n\n  const stopRenderAndRecording = async (renderId) => {\n    if (renderId) {\n      try {\n        const renderData = await stopRender(renderId);\n        console.log(renderData);\n        if ((renderData.status = 200)) {\n          handleRecordingStop(archiveId);\n          setRenderId(null);\n        } else return;\n      } catch (e) {\n        console.log(e);\n      }\n    } else return;\n  };\n\n  const handleRecordingStop = async (archiveId) => {\n    try {\n      if (isRecording) {\n        const data = await stopRecording(archiveId);\n        console.log(data);\n        if (data.status === 200 && data.data) {\n          const { status } = data.data;\n          setRecording(false);\n        }\n      }\n    } catch (e) {\n      console.log(e);\n    }\n  };\n\n  const handleRecordingAction = () => {\n    console.log('trying to start recording');\n    isRecording ? stopRenderAndRecording(renderId) : startRender(roomName);\n    // ? handleRecordingStop(archiveId)\n    // : handleRecordingStart(sessionId);\n  };\n\n  const title = isRecording ? 'Stop Recording' : 'Start Recording';\n\n  return (\n    <Tooltip title={title} aria-label=\"add\">\n      <IconButton\n        // edge=\"start\"\n        // color=\"inherit\"\n        // edge=\"start\"\n        aria-label=\"record\"\n        onClick={handleRecordingAction}\n        // size=\"small\"\n        className={classes.toolbarButtons}\n      >\n        {isRecording ? (\n          <FiberManualRecordIcon\n            fontSize=\"large\"\n            className={localClasses.activeRecordingIcon}\n            style={{ color: '#D50F2C' }}\n          />\n        ) : (\n          <FiberManualRecordIcon fontSize=\"large\" />\n        )}\n      </IconButton>\n    </Tooltip>\n  );\n}\n","import ExitToAppIcon from '@mui/icons-material/ExitToApp';\nimport { IconButton } from '@material-ui/core';\nimport Tooltip from '@material-ui/core/Tooltip';\n\nexport default function EndCallIcon({ classes, handleEndCall }) {\n  return (\n    <Tooltip title=\"End call\" aria-label=\"add\">\n      <IconButton\n        edge=\"start\"\n        color=\"inherit\"\n        aria-label=\"videoCamera\"\n        className={classes.toolbarButtons}\n        style={{ backgroundColor: '#D50F2C' }}\n        onClick={handleEndCall}\n      >\n        <ExitToAppIcon fontSize=\"inherit\" />\n      </IconButton>\n    </Tooltip>\n  );\n}\n","import { makeStyles } from '@material-ui/core/styles';\nexport default makeStyles((theme) => ({\n  toolbarContainer: {\n    backgroundColor: theme.palette.toolbarBackground.main,\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    position: 'absolute',\n    bottom: 0,\n    left: 0,\n    right: 0,\n    height: '90px',\n    // margin: theme.spacing(2),\n    borderRadius: '18px',\n  },\n  paper: {\n    position: 'absolute',\n    display: 'flex',\n    width: 400,\n    backgroundColor: theme.palette.background.paper,\n    border: '2px solid #000',\n    boxShadow: theme.shadows[5],\n    padding: theme.spacing(2, 4, 3),\n  },\n  toolbarMobileContainer: {\n    backgroundColor: theme.palette.toolbarBackground.main,\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    position: 'absolute',\n    bottom: 0,\n    left: 0,\n    right: 0,\n    height: '60px',\n    margin: theme.spacing(2),\n    borderRadius: '25px',\n  },\n  toolbarButtons: {\n    margin: theme.spacing(1),\n    borderRadius: '5em',\n    backgroundColor: '#32353A',\n    color: '#fff',\n  },\n  arrowButton: {\n    borderRadius: '5em',\n    height: '50px',\n    width: '50px',\n    backgroundColor: '#32353A',\n    color: '#fff',\n  },\n  infoButton: {\n    position: 'absolute',\n    left: '0',\n    margin: theme.spacing(1),\n    borderRadius: '5em',\n    height: '50px',\n    width: '50px',\n    backgroundColor: '#32353A',\n    color: '#fff',\n  },\n  groupButton: {\n    margin: '8px',\n  },\n  disabledButton: {\n    backgroundColor: theme.palette.activeButtons.red,\n    '&:hover': {\n      backgroundColor: theme.palette.activeButtons.red,\n    },\n  },\n  activeButton: {\n    backgroundColor: theme.palette.activeButtons.green,\n    '&:hover': {\n      backgroundColor: theme.palette.activeButtons.green,\n    },\n  },\n  activeButtonIcon: {\n    color: theme.palette.activeButtons.green,\n  },\n}));\n","import React from 'react';\n\nimport MuteAudioButton from '../MuteAudioButton';\nimport MuteVideoButton from '../MuteVideoButton';\nimport RecordButton from '../RecordButton';\nimport EndCallButton from '../EndCallButton';\nimport { useSignalling } from '../../hooks/useSignalling';\nimport { useHistory } from 'react-router-dom';\nimport { useParams } from 'react-router';\nimport { usePublisher } from '../../hooks/usePublisher';\n\nimport styles from './styles';\n\nfunction ToolBar({\n  session,\n  handleVideoChange,\n  handleAudioChange,\n  hasVideo,\n  hasAudio,\n}) {\n  const classes = styles();\n  const { push } = useHistory();\n  const { roomName } = useParams();\n  const { renderedSesion } = useSignalling({ session });\n  const { destroyPublisher } = usePublisher();\n\n  const endCall = () => {\n    if (session) {\n      push(`/videorti/${roomName}/${renderedSesion}/end`);\n      // destroyPublisher();\n    }\n  };\n  return (\n    <div className=\"toolbar\">\n      <MuteAudioButton\n        classes={classes}\n        handleAudioChange={handleAudioChange}\n        hasAudio={hasAudio}\n      />\n      <MuteVideoButton\n        classes={classes}\n        handleVideoChange={handleVideoChange}\n        hasVideo={hasVideo}\n      />\n      <RecordButton classes={classes} session={session} />\n      <EndCallButton classes={classes} handleEndCall={endCall} />\n    </div>\n  );\n}\n\nexport default ToolBar;\n","import { makeStyles } from '@material-ui/core/styles';\nexport default makeStyles({\n    root: {\n        top: '0',\n        background: ({ wsStatus }) => {\n            if (wsStatus === 'disconnected') return '#f19c38';\n            if (wsStatus === 'reconnecting') return '#f19c38';\n            if (wsStatus === 'reconnected') return '#4caf50';\n        },\n        /* width: '100%', */\n        justifyContent: 'center',\n    },\n    info: {\n        top: '0',\n        background: '#418be9',\n        justifyContent: 'center',\n    },\n    action: {\n        position: 'absolute',\n        right: '0',\n        paddingRight: '10px',\n    },\n    networkStatusIcons: {\n        paddingRight: '10px',\n    },\n    snackBarContent: {\n        display: 'flex',\n        alignItems: 'flex-end',\n        fontSize: '14px'\n    },\n});\n","import { useEffect, useRef, useState, useCallback, useContext } from 'react';\nimport { useParams } from 'react-router';\n\nimport Banner from '../Banner';\nimport List from '@mui/material/List';\nimport ListItem from '@mui/material/ListItem';\nimport ListItemButton from '@mui/material/ListItemButton';\nimport ListItemIcon from '@mui/material/ListItemIcon';\nimport ListItemText from '@mui/material/ListItemText';\nimport Collapse from '@mui/material/Collapse';\nimport Select from '@mui/material/Select';\nimport MenuItem from '@mui/material/MenuItem';\nimport MedicalInformationIcon from '@mui/icons-material/MedicalInformation';\nimport VaccinesIcon from '@mui/icons-material/Vaccines';\nimport MedicationIcon from '@mui/icons-material/Medication';\nimport BloodtypeIcon from '@mui/icons-material/Bloodtype';\nimport Typography from '@mui/material/Typography';\nimport ContactPageIcon from '@mui/icons-material/ContactPage';\n\nfunction EntitiesList({ listOfEntities, entity }) {\n  const getIcon = (entity) => {\n    switch (entity) {\n      case 'Medical Condition':\n        return <MedicalInformationIcon />;\n      case 'Medication':\n        return <MedicationIcon />;\n      case 'Anatomy':\n        return <BloodtypeIcon />;\n      case 'Treatments':\n        return <VaccinesIcon />;\n      case 'PII':\n        return <ContactPageIcon />;\n      default:\n        return;\n    }\n  };\n\n  const getBgColor = (entity) => {\n    switch (entity) {\n      case 'Medical Condition':\n        return '#5cceff';\n      case 'Medication':\n        return '#f0e442';\n      case 'Anatomy':\n        return '#d185af';\n      case 'Treatments':\n        return '#4a9';\n      case 'PII':\n        return '#999';\n      default:\n        return;\n    }\n  };\n  return (<>\n    <List>\n      <ListItem key={entity} disablePadding>\n        <ListItemIcon>{getIcon(entity)}</ListItemIcon>\n        \n        <Typography\n        style={{ background: getBgColor(entity), padding: '0px' }}\n            variant=\"div\"\n            component=\"div\"\n            gutterBottom\n          >\n            {entity}\n          </Typography>\n        </ListItem>\n    </List>\n    <List sx={{\n      pl:2,\n      display: \"flex\",\n      flexDirection: \"column\",\n      maxHeight: 120,\n      overflow: \"hidden\",\n      overflowY: \"scroll\",\n      bgcolor: 'background.paper'\n    }}>\n      {listOfEntities\n        ? listOfEntities.map((e, i) => <div key={`${e.Text}-${i}`} >\n          <ListItem disablePadding>\n            <ListItemText primary={e.Text} />\n          </ListItem>\n          <Collapse in={true} timeout=\"auto\" unmountOnExit sx={{pl:2}}>\n          <List component=\"div\" disablePadding>\n          {e.concepts && e.concepts.length > 0?\n            <Select value='0' size=\"small\">\n              {e.concepts.map((_e, _i) => \n                <MenuItem key={`item-${i}-${_i}`} value={_i} >\n                  {`${_e.Code} | ${_e.Description} | ${_e.Score}`}\n                </MenuItem>\n                )}\n            </Select>\n            : ''}\n            </List>\n            </Collapse>\n        </div>)\n        : ''}\n    </List>\n  </>);\n}\n\nexport default EntitiesList;\n","import { useEffect, useRef, useState, useCallback, useContext } from 'react';\nimport { useParams } from 'react-router';\n\nimport { usePublisher } from '../../hooks/usePublisher';\nimport { useSession } from '../../hooks/useSession';\nimport { stopRender, stopRecording } from '../../api/fetchRecording';\nimport ToolBar from '../ToolBar';\nimport { getCredentials } from '../../api/fetchCreds';\nimport { UserContext } from '../../context/UserContext';\nimport { useSignalling } from '../../hooks/useSignalling';\n\nimport EntitiesList from '../EntitiesList';\n\nfunction Main() {\n  let translationPlaying = useRef(false);\n  let timePlayingLeft = useRef(0);\n  // const [timePlayingLeft, setTime] = useState(0);\n  const videoContainer = useRef();\n  let { roomName } = useParams();\n  const { preferences } = useContext(UserContext);\n  const [captions, setCaptions] = useState('Say something...');\n\n  const [credentials, setCredentials] = useState(null);\n  const [error, setError] = useState(null);\n  const [hasAudio, setHasAudio] = useState(true);\n  const [hasVideo, setHasVideo] = useState(true);\n  const [userId, setUserId] = useState(null);\n  // const [translationPlaying, setTranslationPlaying] = useState(false);\n\n  const { session, createSession, connected, status } = useSession({\n    container: videoContainer,\n  });\n  // const medicalConditions = ['heart failure', 'type 2 diabetes', 'lung cancer'];\n  const {\n    messages,\n    sendMessage,\n    medication,\n    medicalConditions,\n    piiEntities,\n    anatomyEntities,\n  } = useSignalling({\n    session: session.current,\n  });\n\n  const {\n    publisher,\n    publish,\n    pubInitialised,\n    isPublishing,\n    publisherError,\n    destroyPublisher,\n  } = usePublisher();\n\n  useEffect(() => {\n    setCaptions(messages);\n  }, [messages]);\n\n  useEffect(() => {\n    getCredentials(roomName)\n      .then(({ data }) => {\n        console.log('Credential data: ', data);\n        setCredentials({\n          apiKey: data.apiKey,\n          sessionId: data.sessionId,\n          token: data.token,\n        });\n        setUserId(data.userId);\n      })\n      .catch((err) => {\n        setError(err);\n        console.log(err);\n      });\n  }, [roomName]);\n\n  useEffect(() => {\n    if (credentials) {\n      const { apiKey, sessionId, token } = credentials;\n      console.log(apiKey);\n      createSession({ apiKey, sessionId, token });\n    }\n  }, [createSession, credentials]);\n\n  // useEffect(() => {\n  //   if (preferences.renderId && preferences.archiveId && preferences.recording)\n  //     return () => {\n  //       destroyPublisher();\n  //     };\n  // }, [\n  //   destroyPublisher,\n  //   preferences.archiveId,\n  //   preferences.recording,\n  //   preferences.renderId,\n  // ]);\n\n  const handleAudioChange = useCallback(() => {\n    if (hasAudio) {\n      publisher.publishAudio(false);\n      setHasAudio(false);\n    } else {\n      publisher.publishAudio(true);\n      setHasAudio(true);\n    }\n  }, [hasAudio, publisher]);\n\n  const handleVideoChange = useCallback(() => {\n    if (hasVideo) {\n      publisher.publishVideo(false);\n      setHasVideo(false);\n      try {\n      } catch (e) {\n        console.log(e);\n      }\n    } else {\n      publisher.publishVideo(true);\n      setHasVideo(true);\n      try {\n      } catch (e) {\n        console.log(e);\n      }\n    }\n  }, [hasVideo, publisher]);\n\n  useEffect(() => {\n    if (\n      session.current &&\n      connected &&\n      !pubInitialised &&\n      videoContainer.current\n    ) {\n      // todo It might be better to change state of this component.\n      publish({\n        session: session.current,\n        containerId: videoContainer.current.id,\n      });\n    }\n  }, [publish, session, connected, pubInitialised]);\n\n  return (\n    <>\n      <div className=\"videoContainer\">\n        <div\n          className={'video'}\n          ref={videoContainer}\n          id=\"video-container\"\n        ></div>\n        <div className=\"medicalAnalysis\">\n          <div className=\"entityType\">\n            <EntitiesList\n              listOfEntities={medicalConditions}\n              entity={'Medical Condition'}\n            />\n          </div>\n          <div className=\"entityType\">\n            {medication ? (\n              <EntitiesList listOfEntities={medication} entity={'Medication'} />\n            ) : null}\n          </div>\n          {/* <div className=\"entityType\">\n            <EntitiesList\n              listOfEntities={anatomyEntities}\n              entity={'Anatomy'}\n            />\n          </div> */}\n          <div className=\"entityType\">\n            <EntitiesList listOfEntities={anatomyEntities} entity={'Anatomy'} />\n          </div>\n          <div className=\"entityType\">\n            <EntitiesList listOfEntities={piiEntities} entity={'PII'} />\n          </div>\n        </div>\n      </div>\n      <div className=\"original\"> {captions}</div>\n      <ToolBar\n        handleAudioChange={handleAudioChange}\n        handleVideoChange={handleVideoChange}\n        session={session.current}\n        hasAudio={hasAudio}\n        hasVideo={hasVideo}\n      />\n    </>\n  );\n}\n\nexport default Main;\n","import { makeStyles } from '@material-ui/core/styles';\n// export default makeStyles((theme)=>{\nexport default makeStyles({\n  flex: {\n    height: '100vh',\n    display: 'flex',\n    flexDirection: 'column',\n    flexWrap: 'nowrap',\n    justifyContent: 'flex-start',\n    alignContent: 'stretch',\n    alignItems: 'flex-start',\n  },\n});\n","import Main from '../Main';\nimport styles from './styles.js';\nimport React from 'react';\n\nfunction Wrapper() {\n  const classes = styles();\n  return (\n    <div className={classes.flex}>\n      <Main />\n    </div>\n  );\n}\n\nexport default Wrapper;\n","import { makeStyles } from '@material-ui/core/styles';\nexport default makeStyles((theme) => ({\n  banner: {\n    zIndex: 1,\n    // flexGrow: 0.1,\n    margin: '200px',\n    height: '100px',\n    width: '50%',\n    // position: 'absolute'\n    alignItems: 'center',\n    borderRadius: '30px',\n    backgroundColor: 'black',\n  },\n  container: {\n    ['@media (min-width:768px)']: {\n      marginTop: 10,\n      display: 'flex',\n      flexDirection: 'row',\n    },\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'center',\n    alignContent: 'center',\n  },\n  new__meeting: {\n    color: 'rgb(43,158,250)',\n  },\n\n  meetingInfo: {\n    margin: '100px',\n    width: '50%',\n    height: '100px',\n    color: 'white',\n  },\n  recording: {\n    display: 'flex',\n    flexDirection: 'row',\n    margin: '5px',\n    padding: '5px',\n  },\n  root: {\n    minWidth: 275,\n    margin: 'auto',\n  },\n  bullet: {\n    display: 'inline-block',\n    margin: '0 2px',\n    transform: 'scale(0.8)',\n  },\n  title: {\n    fontSize: 14,\n  },\n  pos: {\n    marginBottom: 12,\n  },\n  centeredFlex: {\n    justifyContent: 'center',\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'center',\n    backgroundColor: 'black',\n    color: 'white',\n    borderRadius: '30px',\n  },\n}));\n","import { useEffect, useState } from 'react';\nimport { fetchRecordings } from '../../api/fetchRecording';\nimport { useParams } from 'react-router';\nimport GetAppIcon from '@mui/icons-material/GetApp';\nimport { IconButton } from '@material-ui/core';\n\nimport Card from '@material-ui/core/Card';\nimport CardActions from '@material-ui/core/CardActions';\nimport CardContent from '@material-ui/core/CardContent';\nimport { useHistory } from 'react-router-dom';\nimport Button from '@material-ui/core/Button';\n\nimport styles from './styles';\n\nexport default function EndCall() {\n  const { push } = useHistory();\n  const [recordings, setRecordings] = useState(null);\n  const classes = styles();\n  const { sessionId } = useParams();\n\n  const redirectNewMeeting = () => {\n    push('/');\n  };\n  useEffect(() => {\n    fetchRecordings(sessionId)\n      .then((data) => {\n        if (data.data) {\n          setRecordings(data.data);\n        }\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  }, [sessionId]);\n\n  return (\n    <div className={classes.container}>\n      <div className={classes.meetingInfo}>\n        <h2 style={{ color: 'white' }}>We hope you enjoyed your meeting</h2>\n        <h2 style={{ color: 'white' }}>This was powered by Vonage</h2>\n\n        <IconButton\n          onClick={redirectNewMeeting}\n          className={classes.new__meeting}\n        >\n          Start new meeting\n        </IconButton>\n      </div>\n      <div className={classes.banner}>\n        <Card className={classes.centeredFlex} variant=\"outlined\">\n          <CardContent>\n            {recordings && recordings.length ? (\n              <h3 style={{ color: 'white' }}>Recordings</h3>\n            ) : (\n              <h3>There are no recordings</h3>\n            )}\n          </CardContent>\n          <CardActions>\n            <div className={classes.root}>\n              {recordings ? (\n                <div className={classes.recording}>\n                  <ul>\n                    {recordings.map((recording) => (\n                      <li key={recording.id}>\n                        Started at: {Date(recording.createdAt)}\n                        {recording.status === 'available' ? (\n                          <Button\n                            color=\"inherit\"\n                            edge=\"start\"\n                            target=\"_blank\"\n                            href={recording.url}\n                          >\n                            <GetAppIcon />\n                          </Button>\n                        ) : null}\n                      </li>\n                    ))}\n                  </ul>\n                </div>\n              ) : null}\n            </div>\n          </CardActions>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","import React, { useContext } from 'react';\nimport { Route, Redirect } from 'react-router-dom';\n\nimport { UserContext } from '../../context/UserContext';\n\nconst ProtectedRoute = ({ component: Component, ...rest }) => {\n  const { preferences } = useContext(UserContext);\n  const roomName = rest?.computedMatch?.params?.roomName;\n\n  return (\n    <Route\n      {...rest}\n      render={(props) =>\n        !roomName ? (\n          <Redirect\n            to={{\n              pathname: '/',\n              //   state: { room: roomName },\n            }}\n          />\n        ) : (\n          <Component {...props} />\n        )\n      }\n    />\n  );\n};\n\nexport default ProtectedRoute;\n","import { makeStyles } from '@material-ui/core/styles';\nexport default makeStyles((theme) => ({\n  header: {\n    flex: '0.5 1 auto',\n    alignSelf: 'stretch',\n    margin: 'auto',\n    padding: '15px 30px',\n    display: 'flex',\n    background: 'linear-gradient(to right, #8728fb, #fea18c) !important',\n    color: '#fff',\n    width: '100%',\n    alignItems: 'center',\n  },\n}));\n","import { makeStyles } from '@material-ui/core/styles';\n// export default makeStyles((theme)=>{\nexport default makeStyles({\n  flex: {\n    height: '100vh',\n    display: 'flex',\n    flexDirection: 'column',\n    flexWrap: 'nowrap',\n    justifyContent: 'flex-start',\n    alignContent: 'stretch',\n    alignItems: 'flex-start',\n  },\n});\n","import Main from '../Main';\nimport Header from '../Header';\nimport styles from './styles.js';\nimport React from 'react';\n\nimport { useEffect, useRef, useState, useCallback, useContext } from 'react';\nimport { useParams } from 'react-router';\n\nimport { usePublisher } from '../../hooks/usePublisher';\nimport { useSession } from '../../hooks/useSession';\n\nimport ToolBar from '../ToolBar';\nimport { getVirtualViewerCredentials } from '../../api/fetchCreds';\nimport { UserContext } from '../../context/UserContext';\nimport { useSignalling } from '../../hooks/useSignalling';\n\nfunction VirtualView() {\n  let translationPlaying = useRef(false);\n  const [userId, setUserId] = useState(null);\n  const [credentials, setCredentials] = useState(null);\n  let timePlayingLeft = useRef(0);\n  // const [timePlayingLeft, setTime] = useState(0);\n  const videoContainer = useRef();\n  let { roomName } = useParams();\n  const { preferences } = useContext(UserContext);\n\n  const ws = useRef(null);\n  const ctx = useRef(null);\n  const gainNodeRef = useRef(null);\n  const context = useRef(null);\n\n  const [captions, setCaptions] = useState('Say something...');\n  const [originalCaptions, setOriginalCaptions] = useState('');\n  const { session, createSession, connected, streams } = useSession({\n    container: videoContainer,\n  });\n  const { messages, sendMessage } = useSignalling({\n    session: session.current,\n  });\n\n  const isVirtualView = () => {\n    if (session) return session.connection.data === 'virtual';\n    else return;\n  };\n\n  useEffect(() => {\n    getVirtualViewerCredentials(roomName)\n      .then(({ data }) => {\n        setCredentials({\n          apiKey: data.apiKey,\n          sessionId: data.sessionId,\n          token: data.token,\n        });\n        setUserId(data.userId);\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  }, [roomName]);\n\n  useEffect(() => {\n    if (credentials) {\n      const { apiKey, sessionId, token } = credentials;\n      console.log(apiKey);\n      createSession({ apiKey, sessionId, token });\n    }\n  }, [createSession, credentials]);\n\n  const wait = (ms) => new Promise((r) => setTimeout(r, ms));\n\n  const handleAudioData = useCallback((decodedData) => {\n    console.log(\n      translationPlaying ? 'theres something playing' : 'free to play'\n    );\n\n    if (translationPlaying.current) {\n      console.log('waiting ' + timePlayingLeft.current + ' seconds');\n      wait(timePlayingLeft.current * 1000).then(() => {\n        const source = ctx.current.createBufferSource();\n        source.buffer = decodedData;\n        source.connect(ctx.current.destination);\n        source.start();\n        // setTranslationPlaying(true);\n        translationPlaying.current = true;\n        source.onended = () => {\n          console.log('Finished playing');\n          translationPlaying.current = false;\n          //setTranslationPlaying(false);\n        };\n      });\n    } else {\n      const source = ctx.current.createBufferSource();\n      source.buffer = decodedData;\n      timePlayingLeft.current = decodedData.duration;\n      // setTime(decodedData.duration);\n      source.connect(ctx.current.destination);\n      source.start();\n      console.log(source);\n      translationPlaying.current = true;\n      //setTranslationPlaying(true);\n      source.onended = () => {\n        console.log('Finished playing');\n        //setTranslationPlaying(false);\n        translationPlaying.current = false;\n      };\n    }\n    // });\n  }, []);\n\n  const startListeners = useCallback(() => {\n    if (ws.current) {\n      context.current = new AudioContext();\n      ws.current.onmessage = (event) => {\n        if (typeof event.data === 'string') {\n          let info = JSON.parse(event.data);\n          const streamId = info.id;\n          if (translationPlaying.current) {\n            wait(timePlayingLeft.current * 1000).then(() => {\n              console.log('waiting');\n              // if (doesWantOriginalCaptions(streamId)) {\n              setOriginalCaptions(`Original : ${info.original}`);\n              // }\n              setCaptions(`Translated: ${info.translated}`);\n              // sendMessage(info.translated);\n            });\n          } else {\n            // if (doesWantOriginalCaptions(streamId)) {\n            setOriginalCaptions(`Original : ${info.original}`);\n            // }\n            setCaptions(`Translated: ${info.translated}`);\n          }\n        } else {\n          const timestamp = new Intl.DateTimeFormat('en-US', {\n            year: 'numeric',\n            month: '2-digit',\n            day: '2-digit',\n            hour: '2-digit',\n            minute: '2-digit',\n            second: '2-digit',\n          }).format(Date.now());\n          console.log('Received audio at ' + timestamp);\n          // sendMessage(event.data);\n\n          context.current\n            .decodeAudioData(event.data)\n            .then(function (decodedData) {\n              handleAudioData(decodedData);\n            });\n        }\n      };\n      // Fired when the WebSocket closes unexpectedly due to an error or lost connetion\n      ws.current.onerror = (err) => {\n        console.error(err);\n      };\n      // Fired when the WebSocket connection has been closed\n      ws.current.onclose = (event) => {\n        console.info('Connection to websocket closed');\n        console.log(event);\n      };\n      ws.current.onopen = (event) => {\n        console.log('Connected');\n\n        // ws.current.send(\n        //   `{\"from\":\"${preferences.defaultSettings.originLanguage}\", \"to\":\"${preferences.defaultSettings.destinationLanguage}\", \"room\":\"${roomName}\",\"user\":\"${preferences.streamId}\", \"digitalHuman\":\"${preferences.digitalHuman}\"}`\n        // );\n      };\n    }\n  }, []);\n\n  useEffect(() => {\n    let AudioContext = window.AudioContext;\n    ctx.current = new AudioContext();\n    let wsUrl = `ws:localhost:5000/virtualviewers/${roomName}`;\n\n    if (process.env.NODE_ENV === 'production') {\n      wsUrl = `${process.env.REACT_APP_WS_URL_PRODUCTION}/virtualviewers/${roomName}`;\n    } else if (process.env.REACT_APP_SERVER_PORT) {\n      wsUrl = `ws:localhost:${process.env.REACT_APP_SERVER_PORT}/virtualviewers/${roomName}`;\n    }\n    wsUrl = wsUrl + encodeURI('?userid=virtualviewer' + '&room=' + roomName);\n    console.log('main WS: ' + wsUrl);\n\n    ws.current = new WebSocket(wsUrl);\n    ws.current.binaryType = 'arraybuffer';\n    startListeners();\n  }, [startListeners, roomName, preferences.streamId]);\n\n  const classes = styles();\n  return (\n    <div className={classes.flex}>\n      <Header />\n      <div className=\"videoContainer\">\n        <div\n          className={'video'}\n          ref={videoContainer}\n          id=\"video-container\"\n        ></div>\n      </div>\n      <div className=\"original\"> {originalCaptions}</div>\n      <div className=\"original\"> {captions}</div>\n    </div>\n  );\n}\n\nexport default VirtualView;\n","import logo from './logo.svg';\nimport './App.css';\nimport WaitingRoom from './components/WaitingRoom';\nimport Wrapper from './components/Wrapper';\nimport EndCall from './components/EndCall';\n\nimport { createTheme } from '@material-ui/core/styles';\nimport { ThemeProvider } from '@material-ui/styles';\nimport { UserContext } from './context/UserContext';\nimport { useMemo, useState } from 'react';\nimport ProtectedRoute from './components/ProtectedRoute';\nimport VirtualView from './components/VirtualView';\n\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n  Redirect,\n} from 'react-router-dom';\n\nlet primary = process.env.REACT_APP_PALETTE_PRIMARY || '#b779ff';\nlet secondary = process.env.REACT_APP_PALETTE_SECONDARY || '#d6219c';\n\nconst theme = () => {\n  return createTheme({\n    palette: {\n      type: 'light',\n      primary: {\n        main: primary,\n      },\n      secondary: {\n        main: secondary,\n      },\n      bodyBackground: {\n        black: '#131415',\n      },\n      callBackground: {\n        main: '#20262D',\n      },\n      toolbarBackground: {\n        main: '#41464D',\n      },\n      activeButtons: {\n        green: '#1C8731',\n        red: '#D50F2C',\n      },\n    },\n  });\n};\n\nfunction App() {\n  const [preferences, setPreferences] = useState({\n    name: null,\n    defaultSettings: {\n\n    },\n  });\n  const preferencesValue = useMemo(\n    () => ({ preferences, setPreferences }),\n    [preferences, setPreferences]\n  );\n  return (\n    <ThemeProvider theme={theme()}>\n      <Router>\n        <UserContext.Provider value={preferencesValue}>\n          <Switch>\n            <ProtectedRoute exact path=\"/room/:roomName\" component={Wrapper} />\n            <Route exact path=\"/room/:roomName/:sessionId/end\">\n              <EndCall />\n            </Route>\n            {/* <Route path=\"/videorti/virtualviewer/:roomName\">\n              <VirtualView />\n            </Route> */}\n            {/* <Route path=\"/videorti/recorder/:roomName\">\n              <VirtualView />\n            </Route> */}\n            <Route path=\"/\">\n              <WaitingRoom />\n            </Route>\n            <Route path=\"*\">\n              <Redirect\n                to={{\n                  pathname: '/',\n                }}\n              />\n            </Route>\n          </Switch>\n        </UserContext.Provider>\n      </Router>\n    </ThemeProvider>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}