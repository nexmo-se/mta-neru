(this["webpackJsonpsimple-vapile"]=this["webpackJsonpsimple-vapile"]||[]).push([[0],{213:function(e,t,n){},214:function(e,t,n){},261:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(18),o=n.n(r),i=(n(213),n(5)),s=(n.p,n(214),n(51)),l=n.n(s),u=n(17),d=n(340),b=n(365),j=n(358),f=n(368),O=n(369),h=n(344),p=Object(a.createContext)(),g=n(44),m=n.n(g),v="".concat("http://localhost:5001");v="".concat("https://neru-ca37991c-neru-mta-project-prod.euw1.serverless.vonage.com");var x=function(e){return m.a.post("".concat(v,"/render"),{roomName:e})},C=function(e){return m.a.get("".concat(v,"/render/stop/").concat(e))},y=function(e){return m.a.get("".concat(v,"/archive/stop/").concat(e))},k=n(22),S=n(32);var I="http://localhost:5001";console.log("production",I),I="".concat("https://neru-ca37991c-neru-mta-project-prod.euw1.serverless.vonage.com");var w=function(){var e=Object(S.a)(Object(k.a)().mark((function e(t){return Object(k.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m.a.get("".concat(I,"/session/").concat(t)));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=Object(S.a)(Object(k.a)().mark((function e(t,n,a,c){return Object(k.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m.a.post("".concat(I,"/startStreaming"),{streamId:t,sessionId:n,streamName:a,specialty:c}));case 1:case"end":return e.stop()}}),e)})));return function(t,n,a,c){return e.apply(this,arguments)}}();function D(){var e=Object(u.h)().roomName,t=Object(a.useContext)(p).preferences,n=Object(a.useState)(!1),r=Object(i.a)(n,2),o=r[0],s=r[1],d=Object(a.useState)(!1),b=Object(i.a)(d,2),j=b[0],f=b[1],O=Object(a.useRef)(),h=Object(a.useState)(null),g=Object(i.a)(h,2),m=g[0],v=g[1],x=Object(a.useState)(null),I=Object(i.a)(x,2),w=I[0],D=I[1],E=Object(a.useState)(null),A=Object(i.a)(E,2),T=A[0],R=A[1],P=function(){var e=Object(a.useState)({audioInputDevices:[],videoInputDevices:[],audioOutputDevices:[]}),t=Object(i.a)(e,2),n=t[0],c=t[1],r=Object(a.useCallback)(Object(S.a)(Object(k.a)().mark((function e(){return Object(k.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices){e.next=3;break}return console.warn("enumerateDevices() not supported."),e.abrupt("return");case 3:return e.abrupt("return",new Promise((function(e,t){l.a.getDevices(function(){var e=Object(S.a)(Object(k.a)().mark((function e(n,a){var r,o,i;return Object(k.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n&&t(n),e.next=3,l.a.getAudioOutputDevices();case 3:r=e.sent,o=a.filter((function(e){return"audioinput"===e.kind.toLowerCase()})),i=a.filter((function(e){return"videoinput"===e.kind.toLowerCase()})),c({audioInputDevices:o,videoInputDevices:i,audioOutputDevices:r});case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())})));case 4:case"end":return e.stop()}}),e)}))),[]);return Object(a.useEffect)((function(){return navigator.mediaDevices.addEventListener("devicechange",r),r(),function(){navigator.mediaDevices.removeEventListener("devicechange",r)}}),[]),{deviceInfo:n,getDevices:r}}(),M=P.deviceInfo,V=P.getDevices,B=c.a.useCallback((function(n){var a=n.stream;console.log(a),t.streamId=a.id;var c=a.publisher.session.id;console.log(c),R(c),console.log({roomName:e,specialty:localStorage.getItem("specialty")}),N(a.id,c,a.name,localStorage.getItem("specialty")).then((function(e){console.log(e.data),console.log("setting connectionId "+e.data.connectionId),D(e.data.connectionId)})).catch((function(e){return console.log(e)})),s(!0)}),[t]),F=Object(a.useCallback)((function(e){e.stream;console.log("destroyed publisher"),O.current=null,f(!1),s(!1)}),[]),z=Object(a.useCallback)((function(e,t){if(console.log("UsePublisher - initPublisher"),O.current)console.log("UsePublisher - Already initiated");else{e||console.log("UsePublisher - Container not available");var n=Object.assign({},t,{width:"100%",height:"100%",name:localStorage.getItem("username"),publishVideo:!0,publishAudio:!0,style:{buttonDisplayMode:"on",nameDisplayMode:"off"},insertMode:"append",showControls:!0,fitMode:"contain"});console.log("usePublisher finalPublisherOptions",n),O.current=l.a.initPublisher(e,n,(function(e){e&&(console.log("[usePublisher]",e),O.current=null),console.log("Publisher Created")})),O.current.on("accessAllowed",V),f(!0),O.current.on("streamCreated",B),O.current.on("streamDestroyed",F)}}),[t.name,B,F]),L=Object(a.useCallback)((function(){O.current&&(T&&w&&O.current.destroy(),t.renderId&&t.archiveId&&(C(t.renderId).then((function(e){return console.log(e)})),y(t.archiveId).then((function(e){return console.log(e)}))),O.current.on("destroyed",(function(){console.log("publisherRef.current Destroyed")})))}),[w,t.archiveId,t.renderId,T]),W=Object(a.useCallback)((function(e){var t=e.session,n=e.containerId,a=e.publisherOptions;if(O.current||z(n,a),t&&O.current&&!o)return new Promise((function(e,n){t.publish(O.current,(function(t){t&&(console.log("Publisher Error",t),s(!1),O.current=null,v(!0),n(t)),console.log("Published"),e(O.current)}))}));O.current}),[z,o]),Y=Object(a.useCallback)((function(e){var t=e.session;O.current&&o&&(t.unpublish(O.current),s(!1),O.current=null)}),[o,O]);return{publisher:O.current,initPublisher:z,destroyPublisher:L,publish:W,pubInitialised:j,unpublish:Y,isPublishing:o,publisherError:m,deviceInfo:M}}var E=n(156),A=n.n(E),T=n(364),R=n(2),P=c.a.memo((function(e){var t=e.hasAudio,n=e.onAudioChange,a=e.className;return Object(R.jsxs)("div",{className:a,children:[Object(R.jsx)(A.a,{}),Object(R.jsx)("div",{children:"Microphone"}),Object(R.jsx)(T.a,{checked:t,onChange:n,name:"AudioToggle"})]})})),M=n(158),V=n.n(M),B=c.a.memo((function(e){var t=e.hasVideo,n=e.onVideoChange,a=e.className;return console.log("Video Setting",t),Object(R.jsxs)("div",{className:a,children:[Object(R.jsx)(V.a,{}),Object(R.jsx)("div",{children:"Video"}),Object(R.jsx)(T.a,{checked:t,onChange:n,name:"VideoToggle"})]})})),F=n(338),z=n(339),L=n(109),W=n(108),Y=Object(F.a)((function(e){return{waitingRoomContainer:{position:"absolute",left:"50%",top:"50%",display:"flex",flexDirection:"column",transform:"translate(-50%, -50%)",backgroundColor:z.a[100],padding:"10px 20px",borderRadius:5,width:"360px"},waitingRoomVideoContainer:{width:"360px",height:"264px"},deviceContainer:{display:"flex",flexDirection:"column",margin:"5px 0"},deviceSettings:{display:"flex",justifyContent:"space-around",alignItems:"center"},selectWidth:{width:"200px"},networkTestContainer:{display:"flex",flexDirection:"column",margin:"10px 5px"},flex:{display:"flex"},green:{color:L.a[600]},red:{color:W.a[600]},containerCenter:{display:"flex",justifyContent:"center",alignItems:"center",margin:"3px",flexDirection:"column"}}})),_=function(e,t){var n="";if(console.log("getSourceDeviceId",e,t),!e||!t)return n;for(var a=0;a<e.length;a+=1)if(e[a].label===t.label){n=e[a].deviceId;break}return n};function J(){var e=Y(),t=Object(a.useContext)(p),n=(t.preferences,t.setPreferences),r=Object(u.g)().push,o=!0,s=!0,g=Object(a.useState)(o),m=Object(i.a)(g,2),v=m[0],x=m[1],C=Object(a.useState)(s),y=Object(i.a)(C,2),k=y[0],S=y[1],I=Object(a.useState)(void 0),w=Object(i.a)(I,2),N=w[0],E=w[1],A=Object(a.useState)(void 0),T=Object(i.a)(A,2),M=T[0],V=T[1],F=Object(a.useState)(void 0),z=Object(i.a)(F,2),L=z[0],W=z[1],J=Object(a.useState)(""),K=Object(i.a)(J,2),U=K[0],G=K[1],H=Object(a.useState)(""),q=Object(i.a)(H,2),Q=q[0],X=q[1],Z=Object(a.useState)(""),$=Object(i.a)(Z,2),ee=$[0],te=$[1],ne=Object(a.useState)("PRIMARYCARE"),ae=Object(i.a)(ne,2),ce=ae[0],re=ae[1],oe=Object(a.useState)(""),ie=Object(i.a)(oe,2),se=ie[0],le=ie[1],ue=Object(a.useState)(""),de=Object(i.a)(ue,2),be=de[0],je=de[1],fe=Object(a.useState)(!1),Oe=Object(i.a)(fe,2),he=Oe[0],pe=Oe[1],ge=Object(a.useState)(!1),me=Object(i.a)(ge,2),ve=me[0],xe=me[1],Ce=Object(a.useRef)(),ye=D(),ke=ye.publisher,Se=ye.initPublisher,Ie=ye.destroyPublisher,we=ye.deviceInfo,Ne=ye.pubInitialised,De=c.a.useCallback((function(e){x(e.target.checked)}),[]),Ee=c.a.useCallback((function(e){S(e.target.checked)}),[]),Ae=c.a.useCallback((function(e){var t=e.target.value;X(e.target.value),ke.setVideoSource(t),E(t)}),[ke,X,E]),Te=c.a.useCallback((function(e){var t=e.target.value;G(t),ke.setAudioSource(t),V(t)}),[ke,G,V]),Re=c.a.useCallback((function(e){var t=e.target.value;te(t),l.a.setAudioOutputDevice(t),W(t)}),[W,te]),Pe=function(){console.log("validateForm",be),console.log("validateForm",se),(""===be?(xe(!0),0):""!==se||(pe(!0),0))&&(localStorage.setItem("username",be),localStorage.setItem("specialty",ce),r("room/".concat(se)))},Me=function(e){13===e.keyCode&&Pe()};return Object(a.useEffect)((function(){var e={publishAudio:o,publishVideo:s};Ce.current&&Se(Ce.current.id,e)}),[Se,o,s]),Object(a.useEffect)((function(){ke&&ke.publishAudio(v)}),[v,ke]),Object(a.useEffect)((function(){ke&&ke.publishVideo(k)}),[k,ke]),Object(a.useEffect)((function(){if(ke&&Ne&&we){var e=ke.getAudioSource();G(_(we.audioInputDevices,e));var t=ke.getVideoSource();X(_(we.videoInputDevices,null===t||void 0===t?void 0:t.track)),l.a.getActiveAudioOutputDevice().then((function(e){te(e.deviceId)}))}}),[we,ke,G,X,te,Ne]),Object(a.useEffect)((function(){return function(){Ie()}}),[Ie]),Object(a.useEffect)((function(){n({defaultSettings:{publishAudio:v,publishVideo:k,audioSource:M,videoSource:N,audioOutput:L}})}),[v,k,n,M,N,L]),Object(R.jsxs)("div",{className:e.waitingRoomContainer,children:[Object(R.jsx)("div",{className:e.containerCenter,children:Object(R.jsxs)("div",{className:e.waitingRoomVideoPreview,children:[Object(R.jsxs)("form",{className:e.form,noValidate:!0,children:[Object(R.jsxs)(d.a,{fullWidth:!0,children:[Object(R.jsx)(b.a,{id:"specialty-select-label",children:"Medical Specialty"}),Object(R.jsx)(j.a,{size:"small",labelId:"specialty-select-label",id:"specialty-select",name:"specialty",value:ce,onChange:function(e){return re(e.target.value)},children:["PRIMARYCARE","CARDIOLOGY","NEUROLOGY","ONCOLOGY","RADIOLOGY","UROLOGY"].map((function(e,t){return Object(R.jsx)(f.a,{value:e,children:e},t)}))})]}),Object(R.jsx)(O.a,{size:"small",variant:"outlined",margin:"dense",required:!0,fullWidth:!0,id:"room-name",label:"Room Name",name:"roomName",autoComplete:"Room Name",error:he,autoFocus:!0,value:se,onChange:function(e){var t=e.target.value;""!==t&&""!==t.trim()?(pe(!1),le(t)):le("")},onKeyDown:Me}),Object(R.jsx)(O.a,{size:"small",variant:"outlined",margin:"none",fullWidth:!0,id:"publisher-name",label:"Name",name:"name",error:ve,required:!0,autoComplete:"Name",value:be,onChange:function(e){var t=e.target.value;""!==t&&""!==t.trim()?(xe(!1),je(t)):je("")},onKeyDown:Me})]}),Object(R.jsx)("div",{className:e.deviceContainer,children:Object(R.jsxs)(R.Fragment,{children:[Object(R.jsxs)(d.a,{margin:"dense",children:[Object(R.jsx)(b.a,{id:"demo-simple-select-label",children:"Select Audio Source"}),Object(R.jsx)(j.a,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:U,onChange:Te,autoWidth:!0,children:we.audioInputDevices.map((function(e){return Object(R.jsx)(f.a,{value:e.deviceId,children:e.label},e.deviceId)}))})]}),Object(R.jsxs)(d.a,{margin:"dense",children:[Object(R.jsx)(b.a,{id:"video",children:"Select Audio Output"}),we.audioOutputDevices&&Object(R.jsx)(j.a,{labelId:"video",id:"demo-simple-select",value:ee,onChange:Re,autoWidth:!0,children:we.audioOutputDevices.map((function(e){return Object(R.jsx)(f.a,{value:e.deviceId,children:e.label},e.deviceId)}))})]}),Object(R.jsxs)(d.a,{margin:"dense",children:[Object(R.jsx)(b.a,{id:"video",children:"Select Video Source"}),we.videoInputDevices&&Object(R.jsx)(j.a,{labelId:"video",id:"demo-simple-select",value:Q,onChange:Ae,autoWidth:!0,children:we.videoInputDevices.map((function(e){return Object(R.jsx)(f.a,{value:e.deviceId,children:e.label},e.deviceId)}))})]})]})}),Object(R.jsxs)("div",{className:e.deviceContainer,children:[Object(R.jsx)(P,{className:e.deviceSettings,hasAudio:v,onAudioChange:De}),Object(R.jsx)(B,{className:e.deviceSettings,hasVideo:k,onVideoChange:Ee})]}),Object(R.jsx)("div",{id:"waiting-room-video-container",className:e.waitingRoomVideoContainer,ref:Ce})]})}),Object(R.jsx)("div",{className:e.containerCenter,children:Object(R.jsx)(h.a,{variant:"contained",color:"secondary",onClick:Pe,children:"Join Call"})})]})}var K=n(20);n(258);function U(e){var t=e.container,n=Object(a.useState)(!1),r=Object(i.a)(n,2),o=r[0],s=r[1],u=Object(a.useState)([]),d=Object(i.a)(u,2),b=d[0],j=d[1],f=Object(a.useRef)(null),O=Object(a.useState)(null),h=Object(i.a)(O,2),p=h[0],g=h[1],m=function(){return"virtualviewer"===window.location.pathname.split("/")[2]},v=function(e){return"EC"!==e},x=c.a.useCallback((function(e){return!m()&&(window.location.pathname.split("/")[2],!0)}),[]),C=c.a.useCallback((function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(console.log(e),f.current&&t.current){var a=Object.assign({},n,{insertMode:"append",width:"100%",height:"100%",fitMode:"contain",style:{buttonDisplayMode:"on",nameDisplayMode:"on"},showControls:!0,subscribeToVideo:v(e.name),subscribeToAudio:x()});f.current.subscribe(e,v(e.name)?t.current.id:null,a)}}),[t,x]),y=Object(a.useCallback)((function(e){console.log("stream created event "+e.stream.name),console.log(" subscribe to video "+v(e.stream.name)),console.log("is experience composer "+m()),C(e.stream),function(e){var t=e.stream;j((function(e){return[].concat(Object(K.a)(e),[t])}))}({stream:e.stream})}),[C]),k=Object(a.useCallback)((function(e){!function(e){var t=e.stream;j((function(e){return e.filter((function(e){return e.id!==t.id}))}))}({stream:e.stream})}),[]),S=Object(a.useCallback)((function(e){g("disconnected")}),[]),I=Object(a.useCallback)((function(e){g("reconnecting")}),[]),w=Object(a.useCallback)((function(e){console.log(e)}),[]),N=Object(a.useCallback)((function(e){var t=e.apiKey,n=e.sessionId,a=e.token;if(!t)throw new Error("Missing apiKey");if(!n)throw new Error("Missing sessionId");if(!a)throw new Error("Missing token");f.current=l.a.initSession(t,n,{});var c={streamCreated:y,streamDestroyed:k,sessionReconnecting:I,sessionDisconnected:S,connectionDestoyed:w};return f.current.on(c),new Promise((function(e,t){f.current.connect(a,(function(n){f.current&&(n?t(n):n||(console.log("Session Connected!"),s(!0),e(f.current)))}))}))}),[w,S,I,y,k]),D=c.a.useCallback((function(){f.current&&(f.current.on("disconnected",(function(){f.current=null})),f.current.disconnect())}),[]);return{session:f,connected:o,createSession:N,destroySession:D,streams:b,status:p}}var G=n(161),H=n.n(G),q=n(160),Q=n.n(q),X=n(337),Z=n(370),$=Object(F.a)({selected:{color:"#b779ff"}});function ee(e){e.toggleAudio;var t=e.hasAudio,n=e.classes,a=e.handleAudioChange,c=t?"Disable Microphone":"Enable Microphone";$();return Object(R.jsx)(R.Fragment,{children:Object(R.jsx)(Z.a,{title:c,"aria-label":"add",children:Object(R.jsx)(X.a,{edge:"start",color:"inherit","aria-label":"mic",onClick:a,className:"".concat(n.toolbarButtons," ").concat(t?"":n.disabledButton,"\n          "),children:t?Object(R.jsx)(H.a,{fontSize:"large"}):Object(R.jsx)(Q.a,{fontSize:"large"})})})})}var te=n(163),ne=n.n(te),ae=n(162),ce=n.n(ae),re=Object(F.a)({selected:{color:"#b779ff",backgroundColor:"black"}});function oe(e){var t=e.classes,n=e.hasVideo,a=e.handleVideoChange,r=n?"Disable Camera":"Enable Camera",o=c.a.useState(null),s=Object(i.a)(o,2),l=(s[0],s[1],c.a.useState([])),u=Object(i.a)(l,2),d=(u[0],u[1],c.a.useState(!1)),b=Object(i.a)(d,2),j=(b[0],b[1],c.a.useRef(null),c.a.useState(0)),f=Object(i.a)(j,2);f[0],f[1],re();return Object(R.jsx)(R.Fragment,{children:Object(R.jsx)(Z.a,{title:r,"aria-label":"add",children:Object(R.jsx)(X.a,{onClick:a,edge:"start","aria-label":"videoCamera",size:"small",className:"".concat(t.arrowButton," ").concat(n?"":t.disabledButton),children:n?Object(R.jsx)(ne.a,{fontSize:"large"}):Object(R.jsx)(ce.a,{fontSize:"large"})})})})}var ie=n(58);function se(e){var t=e.session,n=Object(a.useState)(null),c=Object(i.a)(n,2),r=c[0],o=c[1],s=Object(a.useState)(null),l=Object(i.a)(s,2),u=(l[0],l[1],Object(a.useState)(null)),d=Object(i.a)(u,2),b=d[0],j=d[1],f=Object(a.useState)(null),O=Object(i.a)(f,2),h=O[0],p=O[1],g=Object(a.useState)([]),m=Object(i.a)(g,2),v=m[0],x=m[1],C=Object(a.useState)([]),y=Object(i.a)(C,2),I=y[0],w=y[1],N=Object(a.useState)([]),D=Object(i.a)(N,2),E=D[0],A=D[1],T=Object(a.useState)([]),R=Object(i.a)(T,2),P=R[0],M=R[1],V=Object(a.useState)([]),B=Object(i.a)(V,2),F=B[0],z=B[1],L=Object(a.useCallback)(function(){var e=Object(S.a)(Object(k.a)().mark((function e(n){var a,c;return Object(k.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.type,c=n.data,e.abrupt("return",new Promise((function(e,n){var r=JSON.parse(JSON.stringify({type:a,data:c}));t&&t.signal(r,(function(t){t?n(t):e()}))})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[t]),W=Object(a.useCallback)((function(e){var t=e.data;console.log(t);var n=t.split(":")[0],a=t.split(":")[1];j(n),p(a)}),[]),Y=Object(a.useCallback)((function(e){return L({type:"message",data:e})}),[L]),_=Object(a.useCallback)((function(e){var t=e.data,n=(e.from,JSON.parse(t));n.length&&n.forEach((function(e){"MEDICATION"===(null===e||void 0===e?void 0:e.Category)&&x((function(t){return[{Text:"".concat(e.Text," | ").concat(Math.floor(1e4*e.Score)/100,"%"),concepts:e.RxNormConcepts?e.RxNormConcepts:[]}].concat(Object(K.a)(t))}))}))}),[]),J=Object(a.useCallback)((function(e){var t=e.data,n=(e.from,JSON.parse(t));n.length&&n.forEach((function(e){"MEDICAL_CONDITION"===(null===e||void 0===e?void 0:e.Category)&&w((function(t){return[{Text:"".concat(e.Text," | ").concat(Math.floor(1e4*e.Score)/100,"%"),concepts:e.ICD10CMConcepts?e.ICD10CMConcepts:[]}].concat(Object(K.a)(t))}))}))}),[]),U=Object(a.useCallback)((function(e){var t=e.data,n=(e.from,JSON.parse(t));n.length&&n.forEach((function(e){if("ANATOMY"===(null===e||void 0===e?void 0:e.Category)&&A((function(t){return[{Text:"".concat(e.Type," | ").concat(e.Text)}].concat(Object(K.a)(t))})),"PROTECTED_HEALTH_INFORMATION"===(null===e||void 0===e?void 0:e.Category)&&M((function(t){return[{Text:"".concat(e.Type," | ").concat(e.Text)}].concat(Object(K.a)(t))})),"TEST_TREATMENT_PROCEDURE"===(null===e||void 0===e?void 0:e.Category)){var t=e.Attributes&&e.Attributes[0]?" | "+e.Attributes[0].Text:"";z((function(n){return[{Text:e.Text+t}].concat(Object(K.a)(n))}))}}))}),[]),G=Object(a.useCallback)((function(e){var t=e.data;e.from;console.log("received message"),console.log(JSON.stringify(t)),o(t)}),[]);return Object(a.useEffect)((function(){return t&&(t.on("signal:captions",G),t.on("signal:medicalEntities",U),t.on("signal:archiveStarted",W),t.on("signal:medication",_),t.on("signal:medCondition",J)),function(){t&&(t.off("signal:captions",G),t.off("signal:archiveStarted",W),t.off("signal:medicalEntities",U),t.off("signal:medication",_),t.off("signal:medCondition",_))}}),[t,G,W,U,_,J]),{sendMessage:Y,messages:r,archiveId:b,renderedSesion:h,medicalConditions:I,medication:v,piiEntities:P,anatomyEntities:E,ttpEntities:F}}var le=n(124),ue=n.n(le),de=Object(F.a)((function(e){return{activeRecordingIcon:{boxShadow:"0 0 0 0 rgba(213, 15, 45, 1)",animation:"pulse-red 2s infinite",borderRadius:"100%"}}})),be=n(356);function je(e){var t=e.classes,n=e.session,c=Object(a.useContext)(p),r=c.preferences,o=c.setPreferences,s=Object(u.h)().roomName,l=se({session:n}).archiveId,d=Object(a.useState)(!1),b=Object(i.a)(d,2),j=b[0],f=b[1],O=Object(a.useState)(null),h=Object(i.a)(O,2),g=h[0],m=h[1],v=de(),I=function(){var e=Object(S.a)(Object(k.a)().mark((function e(t){var n,a,c;return Object(k.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!j){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,x(t);case 5:if(!((n=e.sent).status=n.data)){e.next=13;break}a=n.data,c=a.id,a.sessionId,r.renderId=c,m(c),f(!0),e.next=14;break;case 13:return e.abrupt("return");case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(2),console.log(e.t0);case 19:case"end":return e.stop()}}),e,null,[[2,16]])})));return function(t){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){console.log("run preferences hook"),g===r.renderId&&l===r.archiveId||g&&o(Object(ie.a)(Object(ie.a)({},r),{},{renderId:g,archiveId:l}))}),[g,o,l,r]),Object(a.useEffect)((function(){r.recording!==j&&o(Object(ie.a)(Object(ie.a)({},r),{},{recording:j}))}),[j,r,o]);var w=function(){var e=Object(S.a)(Object(k.a)().mark((function e(t){var n;return Object(k.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=19;break}return e.prev=1,e.next=4,C(t);case 4:if(n=e.sent,console.log(n),!(n.status=200)){e.next=11;break}N(l),m(null),e.next=12;break;case 11:return e.abrupt("return");case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),console.log(e.t0);case 17:e.next=20;break;case 19:return e.abrupt("return");case 20:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=Object(S.a)(Object(k.a)().mark((function e(t){var n;return Object(k.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!j){e.next=7;break}return e.next=4,y(t);case 4:n=e.sent,console.log(n),200===n.status&&n.data&&(n.data.status,f(!1));case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),D=j?"Stop Recording":"Start Recording";return Object(R.jsx)(be.a,{title:D,"aria-label":"add",children:Object(R.jsx)(X.a,{"aria-label":"record",onClick:function(){console.log("trying to start recording"),j?w(g):I(s)},className:t.toolbarButtons,children:j?Object(R.jsx)(ue.a,{fontSize:"large",className:v.activeRecordingIcon,style:{color:"#D50F2C"}}):Object(R.jsx)(ue.a,{fontSize:"large"})})})}var fe=n(167),Oe=n.n(fe);function he(e){var t=e.classes,n=e.handleEndCall;return Object(R.jsx)(Z.a,{title:"End call","aria-label":"add",children:Object(R.jsx)(X.a,{edge:"start",color:"inherit","aria-label":"videoCamera",className:t.toolbarButtons,style:{backgroundColor:"#D50F2C"},onClick:n,children:Object(R.jsx)(Oe.a,{fontSize:"inherit"})})})}var pe=Object(F.a)((function(e){return{toolbarContainer:{backgroundColor:e.palette.toolbarBackground.main,display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",bottom:0,left:0,right:0,height:"90px",borderRadius:"18px"},paper:{position:"absolute",display:"flex",width:400,backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)},toolbarMobileContainer:{backgroundColor:e.palette.toolbarBackground.main,display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",bottom:0,left:0,right:0,height:"60px",margin:e.spacing(2),borderRadius:"25px"},toolbarButtons:{margin:e.spacing(1),borderRadius:"5em",backgroundColor:"#32353A",color:"#fff"},arrowButton:{borderRadius:"5em",height:"50px",width:"50px",backgroundColor:"#32353A",color:"#fff"},infoButton:{position:"absolute",left:"0",margin:e.spacing(1),borderRadius:"5em",height:"50px",width:"50px",backgroundColor:"#32353A",color:"#fff"},groupButton:{margin:"8px"},disabledButton:{backgroundColor:e.palette.activeButtons.red,"&:hover":{backgroundColor:e.palette.activeButtons.red}},activeButton:{backgroundColor:e.palette.activeButtons.green,"&:hover":{backgroundColor:e.palette.activeButtons.green}},activeButtonIcon:{color:e.palette.activeButtons.green}}}));var ge=function(e){var t=e.session,n=e.handleVideoChange,a=e.handleAudioChange,c=e.hasVideo,r=e.hasAudio,o=pe(),i=Object(u.g)().push,s=Object(u.h)().roomName,l=se({session:t}).renderedSesion;return D().destroyPublisher,Object(R.jsxs)("div",{className:"toolbar",children:[Object(R.jsx)(ee,{classes:o,handleAudioChange:a,hasAudio:r}),Object(R.jsx)(oe,{classes:o,handleVideoChange:n,hasVideo:c}),Object(R.jsx)(je,{classes:o,session:t}),Object(R.jsx)(he,{classes:o,handleEndCall:function(){t&&i("/videorti/".concat(s,"/").concat(l,"/end"))}})]})};Object(F.a)({root:{top:"0",background:function(e){var t=e.wsStatus;return"disconnected"===t||"reconnecting"===t?"#f19c38":"reconnected"===t?"#4caf50":void 0},justifyContent:"center"},info:{top:"0",background:"#418be9",justifyContent:"center"},action:{position:"absolute",right:"0",paddingRight:"10px"},networkStatusIcons:{paddingRight:"10px"},snackBarContent:{display:"flex",alignItems:"flex-end",fontSize:"14px"}}),n(168),n(362);var me=n(371),ve=n(360),xe=n(349),Ce=n(350),ye=n(372),ke=n(357),Se=n(363),Ie=n(169),we=n.n(Ie),Ne=n(172),De=n.n(Ne),Ee=n(170),Ae=n.n(Ee),Te=n(171),Re=n.n(Te),Pe=n(112),Me=n(173),Ve=n.n(Me),Be=n(174),Fe=n.n(Be);var ze=function(e){var t=e.listOfEntities,n=e.entity;return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(me.a,{children:Object(R.jsxs)(ve.a,{disablePadding:!0,children:[Object(R.jsx)(xe.a,{children:function(e){switch(e){case"Medical Condition":return Object(R.jsx)(we.a,{});case"Medication":return Object(R.jsx)(Ae.a,{});case"Anatomy":return Object(R.jsx)(Re.a,{});case"Treatments":return Object(R.jsx)(De.a,{});case"PII":return Object(R.jsx)(Ve.a,{});case"Test Treatment Procedures":return Object(R.jsx)(Fe.a,{});default:return}}(n)}),Object(R.jsx)(Pe.a,{style:{background:function(e){switch(e){case"Medical Condition":return"#5cceff";case"Medication":return"#f0e442";case"Anatomy":return"#d185af";case"Treatments":case"Test Treatment Procedures":return"#4a9";case"PII":return"#999";default:return}}(n),padding:"0px"},variant:"div",component:"div",gutterBottom:!0,children:n})]},n)}),Object(R.jsx)(me.a,{sx:{pl:2,display:"flex",flexDirection:"column",maxHeight:100,overflow:"hidden",overflowY:"scroll",bgcolor:"background.paper"},children:t?t.map((function(e,t){return Object(R.jsxs)("div",{children:[Object(R.jsx)(ve.a,{disablePadding:!0,children:Object(R.jsx)(Ce.a,{primary:e.Text})}),Object(R.jsx)(ye.a,{in:!0,timeout:"auto",unmountOnExit:!0,sx:{pl:2},children:Object(R.jsx)(me.a,{component:"div",disablePadding:!0,children:e.concepts&&e.concepts.length>0?Object(R.jsx)(ke.a,{value:"0",size:"small",children:e.concepts.map((function(e,n){return Object(R.jsx)(Se.a,{value:n,children:"".concat(e.Code," | ").concat(e.Description," | ").concat(Math.floor(1e4*e.Score)/100,"%")},"item-".concat(t,"-").concat(n))}))}):""})})]},"".concat(e.Text,"-").concat(t))})):""})]})};var Le=function(){Object(a.useRef)(!1),Object(a.useRef)(0);var e=Object(a.useRef)(),t=Object(u.h)().roomName,n=(Object(a.useContext)(p).preferences,Object(a.useState)({text:"Say something...",speaker:""})),c=Object(i.a)(n,2),r=c[0],o=c[1],s=Object(a.useState)(null),l=Object(i.a)(s,2),d=l[0],b=l[1],j=Object(a.useState)(null),f=Object(i.a)(j,2),O=(f[0],f[1]),h=Object(a.useState)(!0),g=Object(i.a)(h,2),m=g[0],v=g[1],x=Object(a.useState)(!0),C=Object(i.a)(x,2),y=C[0],k=C[1],S=Object(a.useState)(null),I=Object(i.a)(S,2),N=(I[0],I[1]),E=U({container:e}),A=E.session,T=E.createSession,P=E.connected,M=(E.status,se({session:A.current})),V=M.messages,B=(M.sendMessage,M.medication),F=M.medicalConditions,z=M.piiEntities,L=M.anatomyEntities,W=M.ttpEntities,Y=D(),_=Y.publisher,J=Y.publish,K=Y.pubInitialised;Y.isPublishing,Y.publisherError,Y.destroyPublisher,Object(a.useEffect)((function(){o(V)}),[V]),Object(a.useEffect)((function(){w(t).then((function(e){var t=e.data;console.log("Credential data: ",t),b({apiKey:t.apiKey,sessionId:t.sessionId,token:t.token}),N(t.userId)})).catch((function(e){O(e),console.log(e)}))}),[t]),Object(a.useEffect)((function(){if(d){var e=d.apiKey,t=d.sessionId,n=d.token;console.log(e),T({apiKey:e,sessionId:t,token:n})}}),[T,d]);var G=Object(a.useCallback)((function(){m?(_.publishAudio(!1),v(!1)):(_.publishAudio(!0),v(!0))}),[m,_]),H=Object(a.useCallback)((function(){y?(_.publishVideo(!1),k(!1)):(_.publishVideo(!0),k(!0))}),[y,_]);return Object(a.useEffect)((function(){A.current&&P&&!K&&e.current&&J({session:A.current,containerId:e.current.id})}),[J,A,P,K]),Object(R.jsxs)(R.Fragment,{children:[Object(R.jsxs)("div",{className:"videoContainer",children:[Object(R.jsx)("div",{className:"video",ref:e,id:"video-container"}),Object(R.jsxs)("div",{className:"medicalAnalysis",sx:{display:"flex",flexDirection:"column",maxHeight:820,overflow:"hidden",overflowY:"scroll"},children:[Object(R.jsx)("div",{className:"entityType",children:Object(R.jsx)(ze,{listOfEntities:F,entity:"Medical Condition"})}),Object(R.jsx)("div",{className:"entityType",children:Object(R.jsx)(ze,{listOfEntities:B,entity:"Medication"})}),Object(R.jsx)("div",{className:"entityType",children:Object(R.jsx)(ze,{listOfEntities:L,entity:"Anatomy"})}),Object(R.jsx)("div",{className:"entityType",children:Object(R.jsx)(ze,{listOfEntities:z,entity:"PII"})}),Object(R.jsx)("div",{className:"entityType",children:Object(R.jsx)(ze,{listOfEntities:W,entity:"Test Treatment Procedures"})})]})]}),Object(R.jsx)("div",{className:"original",children:r?"".concat(r.speaker,": ").concat(r.text):""}),Object(R.jsx)(ge,{handleAudioChange:G,handleVideoChange:H,session:A.current,hasAudio:m,hasVideo:y})]})},We=Object(F.a)({flex:{height:"100vh",display:"flex",flexDirection:"column",flexWrap:"nowrap",justifyContent:"flex-start",alignContent:"stretch",alignItems:"flex-start"}});var Ye=function(){var e=We();return Object(R.jsx)("div",{className:e.flex,children:Object(R.jsx)(Le,{})})},_e=n(176),Je=n.n(_e),Ke=n(352),Ue=n(354),Ge=n(353),He=n(4),qe=Object(F.a)((function(e){var t;return{banner:{zIndex:1,margin:"200px",height:"100px",width:"50%",alignItems:"center",borderRadius:"30px",backgroundColor:"black"},container:(t={},Object(He.a)(t,"@media (min-width:768px)",{marginTop:10,display:"flex",flexDirection:"row"}),Object(He.a)(t,"display","flex"),Object(He.a)(t,"flexDirection","column"),Object(He.a)(t,"alignItems","center"),Object(He.a)(t,"alignContent","center"),t),new__meeting:{color:"rgb(43,158,250)"},meetingInfo:{margin:"100px",width:"50%",height:"100px",color:"white"},recording:{display:"flex",flexDirection:"row",margin:"5px",padding:"5px"},root:{minWidth:275,margin:"auto"},bullet:{display:"inline-block",margin:"0 2px",transform:"scale(0.8)"},title:{fontSize:14},pos:{marginBottom:12},centeredFlex:{justifyContent:"center",display:"flex",flexDirection:"column",alignItems:"center",backgroundColor:"black",color:"white",borderRadius:"30px"}}}));function Qe(){var e=Object(u.g)().push,t=Object(a.useState)(null),n=Object(i.a)(t,2),c=n[0],r=n[1],o=qe(),s=Object(u.h)().sessionId;return Object(a.useEffect)((function(){(function(e){return m.a.get("".concat(v,"/archive/").concat(e))})(s).then((function(e){e.data&&r(e.data)})).catch((function(e){console.log(e)}))}),[s]),Object(R.jsxs)("div",{className:o.container,children:[Object(R.jsxs)("div",{className:o.meetingInfo,children:[Object(R.jsx)("h2",{style:{color:"white"},children:"We hope you enjoyed your meeting"}),Object(R.jsx)("h2",{style:{color:"white"},children:"This was powered by Vonage"}),Object(R.jsx)(X.a,{onClick:function(){e("/")},className:o.new__meeting,children:"Start new meeting"})]}),Object(R.jsx)("div",{className:o.banner,children:Object(R.jsxs)(Ke.a,{className:o.centeredFlex,variant:"outlined",children:[Object(R.jsx)(Ge.a,{children:c&&c.length?Object(R.jsx)("h3",{style:{color:"white"},children:"Recordings"}):Object(R.jsx)("h3",{children:"There are no recordings"})}),Object(R.jsx)(Ue.a,{children:Object(R.jsx)("div",{className:o.root,children:c?Object(R.jsx)("div",{className:o.recording,children:Object(R.jsx)("ul",{children:c.map((function(e){return Object(R.jsxs)("li",{children:["Started at: ",Date(e.createdAt),"available"===e.status?Object(R.jsx)(h.a,{color:"inherit",edge:"start",target:"_blank",href:e.url,children:Object(R.jsx)(Je.a,{})}):null]},e.id)}))})}):null})})]})})]})}var Xe=n(177),Ze=n(355),$e=n(7),et=["component"],tt=function(e){var t,n,c=e.component,r=Object($e.a)(e,et),o=(Object(a.useContext)(p).preferences,null===r||void 0===r||null===(t=r.computedMatch)||void 0===t||null===(n=t.params)||void 0===n?void 0:n.roomName);return Object(R.jsx)(u.b,Object(ie.a)(Object(ie.a)({},r),{},{render:function(e){return o?Object(R.jsx)(c,Object(ie.a)({},e)):Object(R.jsx)(u.a,{to:{pathname:"/"}})}}))};Object(F.a)((function(e){return{header:{flex:"0.5 1 auto",alignSelf:"stretch",margin:"auto",padding:"15px 30px",display:"flex",background:"linear-gradient(to right, #8728fb, #fea18c) !important",color:"#fff",width:"100%",alignItems:"center"}}}));Object(F.a)({flex:{height:"100vh",display:"flex",flexDirection:"column",flexWrap:"nowrap",justifyContent:"flex-start",alignContent:"stretch",alignItems:"flex-start"}});var nt=n(70);var at=function(){var e=Object(a.useState)({name:null,defaultSettings:{}}),t=Object(i.a)(e,2),n=t[0],c=t[1],r=Object(a.useMemo)((function(){return{preferences:n,setPreferences:c}}),[n,c]);return Object(R.jsx)(Ze.a,{theme:Object(Xe.a)({palette:{type:"light",primary:{main:"#b779ff"},secondary:{main:"#d6219c"},bodyBackground:{black:"#131415"},callBackground:{main:"#20262D"},toolbarBackground:{main:"#41464D"},activeButtons:{green:"#1C8731",red:"#D50F2C"}}}),children:Object(R.jsx)(nt.a,{children:Object(R.jsx)(p.Provider,{value:r,children:Object(R.jsxs)(u.d,{children:[Object(R.jsx)(tt,{exact:!0,path:"/room/:roomName",component:Ye}),Object(R.jsx)(u.b,{exact:!0,path:"/room/:roomName/:sessionId/end",children:Object(R.jsx)(Qe,{})}),Object(R.jsx)(u.b,{path:"/",children:Object(R.jsx)(J,{})}),Object(R.jsx)(u.b,{path:"*",children:Object(R.jsx)(u.a,{to:{pathname:"/"}})})]})})})})},ct=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,374)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),a(e),c(e),r(e),o(e)}))};o.a.render(Object(R.jsx)(c.a.StrictMode,{children:Object(R.jsx)(at,{})}),document.getElementById("root")),ct()}},[[261,1,2]]]);
//# sourceMappingURL=main.2c9e7d46.chunk.js.map